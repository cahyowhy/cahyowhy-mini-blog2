if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(t){"use strict";var e=jQuery.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1==e[0]&&9==e[1]&&e[2]<1||e[0]>3)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(),function(t){"use strict";function e(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in e)if(void 0!==t.style[i])return{end:e[i]};return!1}t.fn.emulateTransitionEnd=function(e){var i=!1,n=this;t(this).one("bsTransitionEnd",function(){i=!0});return setTimeout(function(){i||t(n).trigger(t.support.transition.end)},e),this},t(function(){t.support.transition=e(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(e){if(t(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})})}(jQuery),function(t){"use strict";var e='[data-dismiss="alert"]',i=function(i){t(i).on("click",e,this.close)};i.VERSION="3.3.7",i.TRANSITION_DURATION=150,i.prototype.close=function(e){function n(){r.detach().trigger("closed.bs.alert").remove()}var s=t(this),o=s.attr("data-target");o||(o=(o=s.attr("href"))&&o.replace(/.*(?=#[^\s]*$)/,""));var r=t("#"===o?[]:o);e&&e.preventDefault(),r.length||(r=s.closest(".alert")),r.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(r.removeClass("in"),t.support.transition&&r.hasClass("fade")?r.one("bsTransitionEnd",n).emulateTransitionEnd(i.TRANSITION_DURATION):n())};var n=t.fn.alert;t.fn.alert=function(e){return this.each(function(){var n=t(this),s=n.data("bs.alert");s||n.data("bs.alert",s=new i(this)),"string"==typeof e&&s[e].call(n)})},t.fn.alert.Constructor=i,t.fn.alert.noConflict=function(){return t.fn.alert=n,this},t(document).on("click.bs.alert.data-api",e,i.prototype.close)}(jQuery),function(t){"use strict";function e(e){return this.each(function(){var n=t(this),s=n.data("bs.button"),o="object"==typeof e&&e;s||n.data("bs.button",s=new i(this,o)),"toggle"==e?s.toggle():e&&s.setState(e)})}var i=function(e,n){this.$element=t(e),this.options=t.extend({},i.DEFAULTS,n),this.isLoading=!1};i.VERSION="3.3.7",i.DEFAULTS={loadingText:"loading..."},i.prototype.setState=function(e){var i="disabled",n=this.$element,s=n.is("input")?"val":"html",o=n.data();e+="Text",null==o.resetText&&n.data("resetText",n[s]()),setTimeout(t.proxy(function(){n[s](null==o[e]?this.options[e]:o[e]),"loadingText"==e?(this.isLoading=!0,n.addClass(i).attr(i,i).prop(i,!0)):this.isLoading&&(this.isLoading=!1,n.removeClass(i).removeAttr(i).prop(i,!1))},this),0)},i.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var i=this.$element.find("input");"radio"==i.prop("type")?(i.prop("checked")&&(t=!1),e.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==i.prop("type")&&(i.prop("checked")!==this.$element.hasClass("active")&&(t=!1),this.$element.toggleClass("active")),i.prop("checked",this.$element.hasClass("active")),t&&i.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var n=t.fn.button;t.fn.button=e,t.fn.button.Constructor=i,t.fn.button.noConflict=function(){return t.fn.button=n,this},t(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(i){var n=t(i.target).closest(".btn");e.call(n,"toggle"),t(i.target).is('input[type="radio"], input[type="checkbox"]')||(i.preventDefault(),n.is("input,button")?n.trigger("focus"):n.find("input:visible,button:visible").first().trigger("focus"))}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(e){t(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))})}(jQuery),function(t){"use strict";function e(e){return this.each(function(){var n=t(this),s=n.data("bs.carousel"),o=t.extend({},i.DEFAULTS,n.data(),"object"==typeof e&&e),r="string"==typeof e?e:o.slide;s||n.data("bs.carousel",s=new i(this,o)),"number"==typeof e?s.to(e):r?s[r]():o.interval&&s.pause().cycle()})}var i=function(e,i){this.$element=t(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",t.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",t.proxy(this.pause,this)).on("mouseleave.bs.carousel",t.proxy(this.cycle,this))};i.VERSION="3.3.7",i.TRANSITION_DURATION=600,i.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},i.prototype.keydown=function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()}},i.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},i.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},i.prototype.getItemForDirection=function(t,e){var i=this.getItemIndex(e);if(("prev"==t&&0===i||"next"==t&&i==this.$items.length-1)&&!this.options.wrap)return e;var n=(i+("prev"==t?-1:1))%this.$items.length;return this.$items.eq(n)},i.prototype.to=function(t){var e=this,i=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(t>this.$items.length-1||t<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){e.to(t)}):i==t?this.pause().cycle():this.slide(t>i?"next":"prev",this.$items.eq(t))},i.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},i.prototype.next=function(){if(!this.sliding)return this.slide("next")},i.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},i.prototype.slide=function(e,n){var s=this.$element.find(".item.active"),o=n||this.getItemForDirection(e,s),r=this.interval,a="next"==e?"left":"right",h=this;if(o.hasClass("active"))return this.sliding=!1;var l=o[0],c=t.Event("slide.bs.carousel",{relatedTarget:l,direction:a});if(this.$element.trigger(c),!c.isDefaultPrevented()){if(this.sliding=!0,r&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var d=t(this.$indicators.children()[this.getItemIndex(o)]);d&&d.addClass("active")}var u=t.Event("slid.bs.carousel",{relatedTarget:l,direction:a});return t.support.transition&&this.$element.hasClass("slide")?(o.addClass(e),o[0].offsetWidth,s.addClass(a),o.addClass(a),s.one("bsTransitionEnd",function(){o.removeClass([e,a].join(" ")).addClass("active"),s.removeClass(["active",a].join(" ")),h.sliding=!1,setTimeout(function(){h.$element.trigger(u)},0)}).emulateTransitionEnd(i.TRANSITION_DURATION)):(s.removeClass("active"),o.addClass("active"),this.sliding=!1,this.$element.trigger(u)),r&&this.cycle(),this}};var n=t.fn.carousel;t.fn.carousel=e,t.fn.carousel.Constructor=i,t.fn.carousel.noConflict=function(){return t.fn.carousel=n,this};var s=function(i){var n,s=t(this),o=t(s.attr("data-target")||(n=s.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""));if(o.hasClass("carousel")){var r=t.extend({},o.data(),s.data()),a=s.attr("data-slide-to");a&&(r.interval=!1),e.call(o,r),a&&o.data("bs.carousel").to(a),i.preventDefault()}};t(document).on("click.bs.carousel.data-api","[data-slide]",s).on("click.bs.carousel.data-api","[data-slide-to]",s),t(window).on("load",function(){t('[data-ride="carousel"]').each(function(){var i=t(this);e.call(i,i.data())})})}(jQuery),function(t){"use strict";function e(e){var i,n=e.attr("data-target")||(i=e.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"");return t(n)}function i(e){return this.each(function(){var i=t(this),s=i.data("bs.collapse"),o=t.extend({},n.DEFAULTS,i.data(),"object"==typeof e&&e);!s&&o.toggle&&/show|hide/.test(e)&&(o.toggle=!1),s||i.data("bs.collapse",s=new n(this,o)),"string"==typeof e&&s[e]()})}var n=function(e,i){this.$element=t(e),this.options=t.extend({},n.DEFAULTS,i),this.$trigger=t('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};n.VERSION="3.3.7",n.TRANSITION_DURATION=350,n.DEFAULTS={toggle:!0},n.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},n.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e,s=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(s&&s.length&&(e=s.data("bs.collapse"))&&e.transitioning)){var o=t.Event("show.bs.collapse");if(this.$element.trigger(o),!o.isDefaultPrevented()){s&&s.length&&(i.call(s,"hide"),e||s.data("bs.collapse",null));var r=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[r](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var a=function(){this.$element.removeClass("collapsing").addClass("collapse in")[r](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return a.call(this);var h=t.camelCase(["scroll",r].join("-"));this.$element.one("bsTransitionEnd",t.proxy(a,this)).emulateTransitionEnd(n.TRANSITION_DURATION)[r](this.$element[0][h])}}}},n.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var i=this.dimension();this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var s=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!t.support.transition)return s.call(this);this.$element[i](0).one("bsTransitionEnd",t.proxy(s,this)).emulateTransitionEnd(n.TRANSITION_DURATION)}}},n.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},n.prototype.getParent=function(){return t(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(t.proxy(function(i,n){var s=t(n);this.addAriaAndCollapsedClass(e(s),s)},this)).end()},n.prototype.addAriaAndCollapsedClass=function(t,e){var i=t.hasClass("in");t.attr("aria-expanded",i),e.toggleClass("collapsed",!i).attr("aria-expanded",i)};var s=t.fn.collapse;t.fn.collapse=i,t.fn.collapse.Constructor=n,t.fn.collapse.noConflict=function(){return t.fn.collapse=s,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(n){var s=t(this);s.attr("data-target")||n.preventDefault();var o=e(s),r=o.data("bs.collapse")?"toggle":s.data();i.call(o,r)})}(jQuery),function(t){"use strict";function e(e){var i=e.attr("data-target");i||(i=(i=e.attr("href"))&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,""));var n=i&&t(i);return n&&n.length?n:e.parent()}function i(i){i&&3===i.which||(t(n).remove(),t(s).each(function(){var n=t(this),s=e(n),o={relatedTarget:this};s.hasClass("open")&&(i&&"click"==i.type&&/input|textarea/i.test(i.target.tagName)&&t.contains(s[0],i.target)||(s.trigger(i=t.Event("hide.bs.dropdown",o)),i.isDefaultPrevented()||(n.attr("aria-expanded","false"),s.removeClass("open").trigger(t.Event("hidden.bs.dropdown",o)))))}))}var n=".dropdown-backdrop",s='[data-toggle="dropdown"]',o=function(e){t(e).on("click.bs.dropdown",this.toggle)};o.VERSION="3.3.7",o.prototype.toggle=function(n){var s=t(this);if(!s.is(".disabled, :disabled")){var o=e(s),r=o.hasClass("open");if(i(),!r){"ontouchstart"in document.documentElement&&!o.closest(".navbar-nav").length&&t(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(t(this)).on("click",i);var a={relatedTarget:this};if(o.trigger(n=t.Event("show.bs.dropdown",a)),n.isDefaultPrevented())return;s.trigger("focus").attr("aria-expanded","true"),o.toggleClass("open").trigger(t.Event("shown.bs.dropdown",a))}return!1}},o.prototype.keydown=function(i){if(/(38|40|27|32)/.test(i.which)&&!/input|textarea/i.test(i.target.tagName)){var n=t(this);if(i.preventDefault(),i.stopPropagation(),!n.is(".disabled, :disabled")){var o=e(n),r=o.hasClass("open");if(!r&&27!=i.which||r&&27==i.which)return 27==i.which&&o.find(s).trigger("focus"),n.trigger("click");var a=o.find(".dropdown-menu li:not(.disabled):visible a");if(a.length){var h=a.index(i.target);38==i.which&&h>0&&h--,40==i.which&&h<a.length-1&&h++,~h||(h=0),a.eq(h).trigger("focus")}}}};var r=t.fn.dropdown;t.fn.dropdown=function(e){return this.each(function(){var i=t(this),n=i.data("bs.dropdown");n||i.data("bs.dropdown",n=new o(this)),"string"==typeof e&&n[e].call(i)})},t.fn.dropdown.Constructor=o,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=r,this},t(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",s,o.prototype.toggle).on("keydown.bs.dropdown.data-api",s,o.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",o.prototype.keydown)}(jQuery),function(t){"use strict";function e(e,n){return this.each(function(){var s=t(this),o=s.data("bs.modal"),r=t.extend({},i.DEFAULTS,s.data(),"object"==typeof e&&e);o||s.data("bs.modal",o=new i(this,r)),"string"==typeof e?o[e](n):r.show&&o.show(n)})}var i=function(e,i){this.options=i,this.$body=t(document.body),this.$element=t(e),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};i.VERSION="3.3.7",i.TRANSITION_DURATION=300,i.BACKDROP_TRANSITION_DURATION=150,i.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},i.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},i.prototype.show=function(e){var n=this,s=t.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(s),this.isShown||s.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){n.$element.one("mouseup.dismiss.bs.modal",function(e){t(e.target).is(n.$element)&&(n.ignoreBackdropClick=!0)})}),this.backdrop(function(){var s=t.support.transition&&n.$element.hasClass("fade");n.$element.parent().length||n.$element.appendTo(n.$body),n.$element.show().scrollTop(0),n.adjustDialog(),s&&n.$element[0].offsetWidth,n.$element.addClass("in"),n.enforceFocus();var o=t.Event("shown.bs.modal",{relatedTarget:e});s?n.$dialog.one("bsTransitionEnd",function(){n.$element.trigger("focus").trigger(o)}).emulateTransitionEnd(i.TRANSITION_DURATION):n.$element.trigger("focus").trigger(o)}))},i.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(i.TRANSITION_DURATION):this.hideModal())},i.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy(function(t){document===t.target||this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},i.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},i.prototype.resize=function(){this.isShown?t(window).on("resize.bs.modal",t.proxy(this.handleUpdate,this)):t(window).off("resize.bs.modal")},i.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")})},i.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},i.prototype.backdrop=function(e){var n=this,s=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var o=t.support.transition&&s;if(this.$backdrop=t(document.createElement("div")).addClass("modal-backdrop "+s).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",t.proxy(function(t){this.ignoreBackdropClick?this.ignoreBackdropClick=!1:t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide())},this)),o&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;o?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(i.BACKDROP_TRANSITION_DURATION):e()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var r=function(){n.removeBackdrop(),e&&e()};t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",r).emulateTransitionEnd(i.BACKDROP_TRANSITION_DURATION):r()}else e&&e()},i.prototype.handleUpdate=function(){this.adjustDialog()},i.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},i.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},i.prototype.checkScrollbar=function(){var t=window.innerWidth;if(!t){var e=document.documentElement.getBoundingClientRect();t=e.right-Math.abs(e.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},i.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",t+this.scrollbarWidth)},i.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},i.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var n=t.fn.modal;t.fn.modal=e,t.fn.modal.Constructor=i,t.fn.modal.noConflict=function(){return t.fn.modal=n,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(i){var n=t(this),s=n.attr("href"),o=t(n.attr("data-target")||s&&s.replace(/.*(?=#[^\s]+$)/,"")),r=o.data("bs.modal")?"toggle":t.extend({remote:!/#/.test(s)&&s},o.data(),n.data());n.is("a")&&i.preventDefault(),o.one("show.bs.modal",function(t){t.isDefaultPrevented()||o.one("hidden.bs.modal",function(){n.is(":visible")&&n.trigger("focus")})}),e.call(o,r,this)})}(jQuery),function(t){"use strict";var e=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)};e.VERSION="3.3.7",e.TRANSITION_DURATION=150,e.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},e.prototype.init=function(e,i,n){if(this.enabled=!0,this.type=e,this.$element=t(i),this.options=this.getOptions(n),this.$viewport=this.options.viewport&&t(t.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var s=this.options.trigger.split(" "),o=s.length;o--;){var r=s[o];if("click"==r)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=r){var a="hover"==r?"mouseenter":"focusin",h="hover"==r?"mouseleave":"focusout";this.$element.on(a+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(h+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},e.prototype.getDefaults=function(){return e.DEFAULTS},e.prototype.getOptions=function(e){return(e=t.extend({},this.getDefaults(),this.$element.data(),e)).delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},e.prototype.getDelegateOptions=function(){var e={},i=this.getDefaults();return this._options&&t.each(this._options,function(t,n){i[t]!=n&&(e[t]=n)}),e},e.prototype.enter=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),e instanceof t.Event&&(i.inState["focusin"==e.type?"focus":"hover"]=!0),i.tip().hasClass("in")||"in"==i.hoverState)i.hoverState="in";else{if(clearTimeout(i.timeout),i.hoverState="in",!i.options.delay||!i.options.delay.show)return i.show();i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)}},e.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},e.prototype.leave=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),e instanceof t.Event&&(i.inState["focusout"==e.type?"focus":"hover"]=!1),!i.isInStateTrue()){if(clearTimeout(i.timeout),i.hoverState="out",!i.options.delay||!i.options.delay.hide)return i.hide();i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)}},e.prototype.show=function(){var i=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(i);var n=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(i.isDefaultPrevented()||!n)return;var s=this,o=this.tip(),r=this.getUID(this.type);this.setContent(),o.attr("id",r),this.$element.attr("aria-describedby",r),this.options.animation&&o.addClass("fade");var a="function"==typeof this.options.placement?this.options.placement.call(this,o[0],this.$element[0]):this.options.placement,h=/\s?auto?\s?/i,l=h.test(a);l&&(a=a.replace(h,"")||"top"),o.detach().css({top:0,left:0,display:"block"}).addClass(a).data("bs."+this.type,this),this.options.container?o.appendTo(this.options.container):o.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var c=this.getPosition(),d=o[0].offsetWidth,u=o[0].offsetHeight;if(l){var p=a,f=this.getPosition(this.$viewport);a="bottom"==a&&c.bottom+u>f.bottom?"top":"top"==a&&c.top-u<f.top?"bottom":"right"==a&&c.right+d>f.width?"left":"left"==a&&c.left-d<f.left?"right":a,o.removeClass(p).addClass(a)}var g=this.getCalculatedOffset(a,c,d,u);this.applyPlacement(g,a);var m=function(){var t=s.hoverState;s.$element.trigger("shown.bs."+s.type),s.hoverState=null,"out"==t&&s.leave(s)};t.support.transition&&this.$tip.hasClass("fade")?o.one("bsTransitionEnd",m).emulateTransitionEnd(e.TRANSITION_DURATION):m()}},e.prototype.applyPlacement=function(e,i){var n=this.tip(),s=n[0].offsetWidth,o=n[0].offsetHeight,r=parseInt(n.css("margin-top"),10),a=parseInt(n.css("margin-left"),10);isNaN(r)&&(r=0),isNaN(a)&&(a=0),e.top+=r,e.left+=a,t.offset.setOffset(n[0],t.extend({using:function(t){n.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),n.addClass("in");var h=n[0].offsetWidth,l=n[0].offsetHeight;"top"==i&&l!=o&&(e.top=e.top+o-l);var c=this.getViewportAdjustedDelta(i,e,h,l);c.left?e.left+=c.left:e.top+=c.top;var d=/top|bottom/.test(i),u=d?2*c.left-s+h:2*c.top-o+l,p=d?"offsetWidth":"offsetHeight";n.offset(e),this.replaceArrow(u,n[0][p],d)},e.prototype.replaceArrow=function(t,e,i){this.arrow().css(i?"left":"top",50*(1-t/e)+"%").css(i?"top":"left","")},e.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},e.prototype.hide=function(i){function n(){"in"!=s.hoverState&&o.detach(),s.$element&&s.$element.removeAttr("aria-describedby").trigger("hidden.bs."+s.type),i&&i()}var s=this,o=t(this.$tip),r=t.Event("hide.bs."+this.type);if(this.$element.trigger(r),!r.isDefaultPrevented())return o.removeClass("in"),t.support.transition&&o.hasClass("fade")?o.one("bsTransitionEnd",n).emulateTransitionEnd(e.TRANSITION_DURATION):n(),this.hoverState=null,this},e.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},e.prototype.hasContent=function(){return this.getTitle()},e.prototype.getPosition=function(e){var i=(e=e||this.$element)[0],n="BODY"==i.tagName,s=i.getBoundingClientRect();null==s.width&&(s=t.extend({},s,{width:s.right-s.left,height:s.bottom-s.top}));var o=window.SVGElement&&i instanceof window.SVGElement,r=n?{top:0,left:0}:o?null:e.offset(),a={scroll:n?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},h=n?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},s,a,h,r)},e.prototype.getCalculatedOffset=function(t,e,i,n){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-n,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-n/2,left:e.left-i}:{top:e.top+e.height/2-n/2,left:e.left+e.width}},e.prototype.getViewportAdjustedDelta=function(t,e,i,n){var s={top:0,left:0};if(!this.$viewport)return s;var o=this.options.viewport&&this.options.viewport.padding||0,r=this.getPosition(this.$viewport);if(/right|left/.test(t)){var a=e.top-o-r.scroll,h=e.top+o-r.scroll+n;a<r.top?s.top=r.top-a:h>r.top+r.height&&(s.top=r.top+r.height-h)}else{var l=e.left-o,c=e.left+o+i;l<r.left?s.left=r.left-l:c>r.right&&(s.left=r.left+r.width-c)}return s},e.prototype.getTitle=function(){var t=this.$element,e=this.options;return t.attr("data-original-title")||("function"==typeof e.title?e.title.call(t[0]):e.title)},e.prototype.getUID=function(t){do{t+=~~(1e6*Math.random())}while(document.getElementById(t));return t},e.prototype.tip=function(){if(!this.$tip&&(this.$tip=t(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},e.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},e.prototype.enable=function(){this.enabled=!0},e.prototype.disable=function(){this.enabled=!1},e.prototype.toggleEnabled=function(){this.enabled=!this.enabled},e.prototype.toggle=function(e){var i=this;e&&((i=t(e.currentTarget).data("bs."+this.type))||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i))),e?(i.inState.click=!i.inState.click,i.isInStateTrue()?i.enter(i):i.leave(i)):i.tip().hasClass("in")?i.leave(i):i.enter(i)},e.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null,t.$element=null})};var i=t.fn.tooltip;t.fn.tooltip=function(i){return this.each(function(){var n=t(this),s=n.data("bs.tooltip"),o="object"==typeof i&&i;!s&&/destroy|hide/.test(i)||(s||n.data("bs.tooltip",s=new e(this,o)),"string"==typeof i&&s[i]())})},t.fn.tooltip.Constructor=e,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=i,this}}(jQuery),function(t){"use strict";var e=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");e.VERSION="3.3.7",e.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),e.prototype=t.extend({},t.fn.tooltip.Constructor.prototype),e.prototype.constructor=e,e.prototype.getDefaults=function(){return e.DEFAULTS},e.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),i=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof i?"html":"append":"text"](i),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},e.prototype.hasContent=function(){return this.getTitle()||this.getContent()},e.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},e.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var i=t.fn.popover;t.fn.popover=function(i){return this.each(function(){var n=t(this),s=n.data("bs.popover"),o="object"==typeof i&&i;!s&&/destroy|hide/.test(i)||(s||n.data("bs.popover",s=new e(this,o)),"string"==typeof i&&s[i]())})},t.fn.popover.Constructor=e,t.fn.popover.noConflict=function(){return t.fn.popover=i,this}}(jQuery),function(t){"use strict";function e(i,n){this.$body=t(document.body),this.$scrollElement=t(t(i).is(document.body)?window:i),this.options=t.extend({},e.DEFAULTS,n),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",t.proxy(this.process,this)),this.refresh(),this.process()}function i(i){return this.each(function(){var n=t(this),s=n.data("bs.scrollspy"),o="object"==typeof i&&i;s||n.data("bs.scrollspy",s=new e(this,o)),"string"==typeof i&&s[i]()})}e.VERSION="3.3.7",e.DEFAULTS={offset:10},e.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},e.prototype.refresh=function(){var e=this,i="offset",n=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),t.isWindow(this.$scrollElement[0])||(i="position",n=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var e=t(this),s=e.data("target")||e.attr("href"),o=/^#./.test(s)&&t(s);return o&&o.length&&o.is(":visible")&&[[o[i]().top+n,s]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){e.offsets.push(this[0]),e.targets.push(this[1])})},e.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,i=this.getScrollHeight(),n=this.options.offset+i-this.$scrollElement.height(),s=this.offsets,o=this.targets,r=this.activeTarget;if(this.scrollHeight!=i&&this.refresh(),e>=n)return r!=(t=o[o.length-1])&&this.activate(t);if(r&&e<s[0])return this.activeTarget=null,this.clear();for(t=s.length;t--;)r!=o[t]&&e>=s[t]&&(void 0===s[t+1]||e<s[t+1])&&this.activate(o[t])},e.prototype.activate=function(e){this.activeTarget=e,this.clear();var i=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',n=t(i).parents("li").addClass("active");n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate.bs.scrollspy")},e.prototype.clear=function(){t(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var n=t.fn.scrollspy;t.fn.scrollspy=i,t.fn.scrollspy.Constructor=e,t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=n,this},t(window).on("load.bs.scrollspy.data-api",function(){t('[data-spy="scroll"]').each(function(){var e=t(this);i.call(e,e.data())})})}(jQuery),function(t){"use strict";function e(e){return this.each(function(){var n=t(this),s=n.data("bs.tab");s||n.data("bs.tab",s=new i(this)),"string"==typeof e&&s[e]()})}var i=function(e){this.element=t(e)};i.VERSION="3.3.7",i.TRANSITION_DURATION=150,i.prototype.show=function(){var e=this.element,i=e.closest("ul:not(.dropdown-menu)"),n=e.data("target");if(n||(n=(n=e.attr("href"))&&n.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var s=i.find(".active:last a"),o=t.Event("hide.bs.tab",{relatedTarget:e[0]}),r=t.Event("show.bs.tab",{relatedTarget:s[0]});if(s.trigger(o),e.trigger(r),!r.isDefaultPrevented()&&!o.isDefaultPrevented()){var a=t(n);this.activate(e.closest("li"),i),this.activate(a,a.parent(),function(){s.trigger({type:"hidden.bs.tab",relatedTarget:e[0]}),e.trigger({type:"shown.bs.tab",relatedTarget:s[0]})})}}},i.prototype.activate=function(e,n,s){function o(){r.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),e.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),a?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu").length&&e.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),s&&s()}var r=n.find("> .active"),a=s&&t.support.transition&&(r.length&&r.hasClass("fade")||!!n.find("> .fade").length);r.length&&a?r.one("bsTransitionEnd",o).emulateTransitionEnd(i.TRANSITION_DURATION):o(),r.removeClass("in")};var n=t.fn.tab;t.fn.tab=e,t.fn.tab.Constructor=i,t.fn.tab.noConflict=function(){return t.fn.tab=n,this};var s=function(i){i.preventDefault(),e.call(t(this),"show")};t(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',s).on("click.bs.tab.data-api",'[data-toggle="pill"]',s)}(jQuery),function(t){"use strict";function e(e){return this.each(function(){var n=t(this),s=n.data("bs.affix"),o="object"==typeof e&&e;s||n.data("bs.affix",s=new i(this,o)),"string"==typeof e&&s[e]()})}var i=function(e,n){this.options=t.extend({},i.DEFAULTS,n),this.$target=t(this.options.target).on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(e),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};i.VERSION="3.3.7",i.RESET="affix affix-top affix-bottom",i.DEFAULTS={offset:0,target:window},i.prototype.getState=function(t,e,i,n){var s=this.$target.scrollTop(),o=this.$element.offset(),r=this.$target.height();if(null!=i&&"top"==this.affixed)return s<i&&"top";if("bottom"==this.affixed)return null!=i?!(s+this.unpin<=o.top)&&"bottom":!(s+r<=t-n)&&"bottom";var a=null==this.affixed,h=a?s:o.top,l=a?r:e;return null!=i&&s<=i?"top":null!=n&&h+l>=t-n&&"bottom"},i.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(i.RESET).addClass("affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},i.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},i.prototype.checkPosition=function(){if(this.$element.is(":visible")){var e=this.$element.height(),n=this.options.offset,s=n.top,o=n.bottom,r=Math.max(t(document).height(),t(document.body).height());"object"!=typeof n&&(o=s=n),"function"==typeof s&&(s=n.top(this.$element)),"function"==typeof o&&(o=n.bottom(this.$element));var a=this.getState(r,e,s,o);if(this.affixed!=a){null!=this.unpin&&this.$element.css("top","");var h="affix"+(a?"-"+a:""),l=t.Event(h+".bs.affix");if(this.$element.trigger(l),l.isDefaultPrevented())return;this.affixed=a,this.unpin="bottom"==a?this.getPinnedOffset():null,this.$element.removeClass(i.RESET).addClass(h).trigger(h.replace("affix","affixed")+".bs.affix")}"bottom"==a&&this.$element.offset({top:r-e-o})}};var n=t.fn.affix;t.fn.affix=e,t.fn.affix.Constructor=i,t.fn.affix.noConflict=function(){return t.fn.affix=n,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var i=t(this),n=i.data();n.offset=n.offset||{},null!=n.offsetBottom&&(n.offset.bottom=n.offsetBottom),null!=n.offsetTop&&(n.offset.top=n.offsetTop),e.call(i,n)})})}(jQuery),function(){var t,e,i,n,s,o,r,a,h,l,c,d,u,p,f,g,m,v,y,b,x,w,C,I,D,T={}.hasOwnProperty,$=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1},E=[].slice;I=Array.prototype.slice,t=function(t,e){return null==e&&(e=document),"object"==typeof t||"undefined"!=typeof exports&&null!==exports?t:e.querySelector(t)},w=function(){function t(){}return t.uniqid=function(){var t;return t=0,{get:function(){return t++}}}(),t.extend=function(t){var e,i,n,s,o,r;for(i=t,o=0,r=(s=I.call(arguments,1)).length;o<r;o++){e=s[o];for(n in e)T.call(e,n)&&(i[n]=e[n])}return i},t.clampRGB=function(t){return t<0?0:t>255?255:t},t.copyAttributes=function(t,e,i){var n,s,o,r,a,h;for(null==i&&(i={}),h=[],s=0,o=(r=t.attributes).length;s<o;s++)n=r[s],null!=i.except&&(a=n.nodeName,$.call(i.except,a)>=0)||h.push(e.setAttribute(n.nodeName,n.nodeValue));return h},t.dataArray=function(t){return null==t&&(t=0),s.NodeJS||null!=window.Uint8Array?new Uint8Array(t):new Array(t)},t}(),"undefined"!=typeof exports&&null!==exports?(b=exports,r=require("canvas"),u=r.Image,l=require("fibers"),C=require("fs")):b=window,b.Caman=s=function(){function i(){var t,n,s,o=this;if(0===arguments.length)throw"Invalid arguments";return this instanceof i?(this.finishInit=this.finishInit.bind(this),this.imageLoaded=this.imageLoaded.bind(this),t=arguments[0],i.NodeJS||(s=parseInt(i.getAttrId(t[0]),10),n="function"==typeof t[1]?t[1]:"function"==typeof t[2]?t[2]:function(){},isNaN(s)||!x.has(s))?(this.id=w.uniqid.get(),this.initializedPixelData=this.originalPixelData=null,this.cropCoordinates={x:0,y:0},this.cropped=!1,this.resized=!1,this.pixelStack=[],this.layerStack=[],this.canvasQueue=[],this.currentLayer=null,this.scaled=!1,this.analyze=new e(this),this.renderer=new y(this),this.domIsLoaded(function(){return o.parseArguments(t),o.setup()}),this):x.execute(s,n)):new i(arguments)}return i.version={release:"4.1.1",date:"4/8/2013"},i.DEBUG=!1,i.NodeJS="undefined"!=typeof exports&&null!==exports,i.autoload=!i.NodeJS,i.allowRevert=!0,i.crossOrigin="anonymous",i.toString=function(){return"Version "+i.version.release+", Released "+i.version.date},i.remoteProxy="",i.proxyParam="camanProxyUrl",i.getAttrId=function(e){return!!i.NodeJS||("string"==typeof e&&(e=t(e)),null==e||null==e.getAttribute?null:e.getAttribute("data-caman-id"))},i.prototype.domIsLoaded=function(t){var e,n=this;return i.NodeJS?setTimeout(function(){return t.call(n)},0):"complete"===document.readyState?(f.debug("DOM initialized"),setTimeout(function(){return t.call(n)},0)):(e=function(){if("complete"===document.readyState)return f.debug("DOM initialized"),t.call(n)},document.addEventListener("readystatechange",e,!1))},i.prototype.parseArguments=function(t){var e,i,n,s;if(0===t.length)throw"Invalid arguments given";if(this.initObj=null,this.initType=null,this.imageUrl=null,this.callback=function(){},this.setInitObject(t[0]),1!==t.length){switch(typeof t[1]){case"string":this.imageUrl=t[1];break;case"function":this.callback=t[1]}if(2!==t.length&&(this.callback=t[2],4===t.length)){n=t[4],s=[];for(e in n)T.call(n,e)&&(i=n[e],s.push(this.options[e]=i));return s}}},i.prototype.setInitObject=function(e){if(i.NodeJS)return this.initObj=e,void(this.initType="node");if(this.initObj="object"==typeof e?e:t(e),null==this.initObj)throw"Could not find image or canvas for initialization.";return this.initType=this.initObj.nodeName.toLowerCase()},i.prototype.setup=function(){switch(this.initType){case"node":return this.initNode();case"img":return this.initImage();case"canvas":return this.initCanvas()}},i.prototype.initNode=function(){var t=this;return f.debug("Initializing for NodeJS"),this.image=new u,this.image.onload=function(){return f.debug("Image loaded. Width = "+t.imageWidth()+", Height = "+t.imageHeight()),t.canvas=new r(t.imageWidth(),t.imageHeight()),t.finishInit()},this.image.onerror=function(t){throw t},this.image.src=this.initObj},i.prototype.initImage=function(){return this.image=this.initObj,this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),w.copyAttributes(this.image,this.canvas,{except:["src"]}),this.image.parentNode.replaceChild(this.canvas,this.image),this.imageAdjustments(),this.waitForImageLoaded()},i.prototype.initCanvas=function(){return this.canvas=this.initObj,this.context=this.canvas.getContext("2d"),null!=this.imageUrl?(this.image=document.createElement("img"),this.image.src=this.imageUrl,this.imageAdjustments(),this.waitForImageLoaded()):this.finishInit()},i.prototype.imageAdjustments=function(){if(this.needsHiDPISwap()&&(f.debug(this.image.src,"->",this.hiDPIReplacement()),this.swapped=!0,this.image.src=this.hiDPIReplacement()),d.isRemote(this.image))return this.image.src=d.proxyUrl(this.image.src),f.debug("Remote image detected, using URL = "+this.image.src)},i.prototype.waitForImageLoaded=function(){return this.isImageLoaded()?this.imageLoaded():this.image.onload=this.imageLoaded},i.prototype.isImageLoaded=function(){return!!this.image.complete&&(null==this.image.naturalWidth||0!==this.image.naturalWidth)},i.prototype.imageWidth=function(){return this.image.width||this.image.naturalWidth},i.prototype.imageHeight=function(){return this.image.height||this.image.naturalHeight},i.prototype.imageLoaded=function(){return f.debug("Image loaded. Width = "+this.imageWidth()+", Height = "+this.imageHeight()),this.swapped?(this.canvas.width=this.imageWidth()/this.hiDPIRatio(),this.canvas.height=this.imageHeight()/this.hiDPIRatio()):(this.canvas.width=this.imageWidth(),this.canvas.height=this.imageHeight()),this.finishInit()},i.prototype.finishInit=function(){var t,e,n,s,o;if(null==this.context&&(this.context=this.canvas.getContext("2d")),this.originalWidth=this.preScaledWidth=this.width=this.canvas.width,this.originalHeight=this.preScaledHeight=this.height=this.canvas.height,this.hiDPIAdjustments(),this.hasId()||this.assignId(),null!=this.image&&this.context.drawImage(this.image,0,0,this.imageWidth(),this.imageHeight(),0,0,this.preScaledWidth,this.preScaledHeight),this.reloadCanvasData(),i.allowRevert)for(this.initializedPixelData=w.dataArray(this.pixelData.length),this.originalPixelData=w.dataArray(this.pixelData.length),t=n=0,s=(o=this.pixelData).length;n<s;t=++n)e=o[t],this.initializedPixelData[t]=e,this.originalPixelData[t]=e;return this.dimensions={width:this.canvas.width,height:this.canvas.height},x.put(this.id,this),this.callback.call(this,this),this.callback=function(){}},i.prototype.reloadCanvasData=function(){return this.imageData=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),this.pixelData=this.imageData.data},i.prototype.resetOriginalPixelData=function(){var t,e,n,s,o;if(!i.allowRevert)throw"Revert disabled";for(this.originalPixelData=w.dataArray(this.pixelData.length),o=[],e=0,n=(s=this.pixelData).length;e<n;e++)t=s[e],o.push(this.originalPixelData.push(t));return o},i.prototype.hasId=function(){return null!=i.getAttrId(this.canvas)},i.prototype.assignId=function(){if(!i.NodeJS&&!this.canvas.getAttribute("data-caman-id"))return this.canvas.setAttribute("data-caman-id",this.id)},i.prototype.hiDPIDisabled=function(){return null!==this.canvas.getAttribute("data-caman-hidpi-disabled")},i.prototype.hiDPIAdjustments=function(){var t;if(!i.NodeJS&&!this.hiDPIDisabled())return 1!==(t=this.hiDPIRatio())?(f.debug("HiDPI ratio = "+t),this.scaled=!0,this.preScaledWidth=this.canvas.width,this.preScaledHeight=this.canvas.height,this.canvas.width=this.preScaledWidth*t,this.canvas.height=this.preScaledHeight*t,this.canvas.style.width=this.preScaledWidth+"px",this.canvas.style.height=this.preScaledHeight+"px",this.context.scale(t,t),this.width=this.originalWidth=this.canvas.width,this.height=this.originalHeight=this.canvas.height):void 0},i.prototype.hiDPIRatio=function(){var t,e;return e=window.devicePixelRatio||1,t=this.context.webkitBackingStorePixelRatio||this.context.mozBackingStorePixelRatio||this.context.msBackingStorePixelRatio||this.context.oBackingStorePixelRatio||this.context.backingStorePixelRatio||1,e/t},i.prototype.hiDPICapable=function(){return null!=window.devicePixelRatio&&1!==window.devicePixelRatio},i.prototype.needsHiDPISwap=function(){return!(this.hiDPIDisabled()||!this.hiDPICapable())&&null!==this.hiDPIReplacement()},i.prototype.hiDPIReplacement=function(){return null==this.image?null:this.image.getAttribute("data-caman-hidpi")},i.prototype.replaceCanvas=function(t){var e;return e=this.canvas,this.canvas=t,this.context=this.canvas.getContext("2d"),e.parentNode.replaceChild(this.canvas,e),this.width=this.canvas.width,this.height=this.canvas.height,this.reloadCanvasData(),this.dimensions={width:this.canvas.width,height:this.canvas.height}},i.prototype.render=function(t){var e=this;return null==t&&(t=function(){}),h.trigger(this,"renderStart"),this.renderer.execute(function(){return e.context.putImageData(e.imageData,0,0),t.call(e)})},i.prototype.revert=function(){var t,e,n,s,o;if(!i.allowRevert)throw"Revert disabled";for(t=n=0,s=(o=this.originalVisiblePixels()).length;n<s;t=++n)e=o[t],this.pixelData[t]=e;return this.context.putImageData(this.imageData,0,0)},i.prototype.reset=function(){var t,e,i,n,s,o,r,a,h;for(t=document.createElement("canvas"),w.copyAttributes(this.canvas,t),t.width=this.originalWidth,t.height=this.originalHeight,o=(n=(e=t.getContext("2d")).getImageData(0,0,t.width,t.height)).data,i=r=0,a=(h=this.initializedPixelData).length;r<a;i=++r)s=h[i],o[i]=s;return e.putImageData(n,0,0),this.cropCoordinates={x:0,y:0},this.resized=!1,this.replaceCanvas(t)},i.prototype.originalVisiblePixels=function(){var t,e,n,s,o,r,a,h,l,c,d,u,p,f,g,v,y,b,x,w,C;if(!i.allowRevert)throw"Revert disabled";if(c=[],u=this.cropCoordinates.x,s=u+this.width,p=this.cropCoordinates.y,o=p+this.height,this.resized){for((t=document.createElement("canvas")).width=this.originalWidth,t.height=this.originalHeight,l=(a=(n=t.getContext("2d")).getImageData(0,0,t.width,t.height)).data,r=g=0,y=(b=this.originalPixelData).length;g<y;r=++g)h=b[r],l[r]=h;n.putImageData(a,0,0),(d=document.createElement("canvas")).width=this.width,d.height=this.height,(n=d.getContext("2d")).drawImage(t,0,0,this.originalWidth,this.originalHeight,0,0,this.width,this.height),l=n.getImageData(0,0,this.width,this.height).data,f=this.width}else l=this.originalPixelData,f=this.originalWidth;for(r=v=0,x=l.length;v<x;r=v+=4)u<=(w=(e=m.locationToCoordinates(r,f)).x)&&w<s&&p<=(C=e.y)&&C<o&&c.push(l[r],l[r+1],l[r+2],l[r+3]);return c},i.prototype.process=function(t,e){return this.renderer.add({type:c.Type.Single,name:t,processFn:e}),this},i.prototype.processKernel=function(t,e,i,n){var s,o,r;if(!i)for(i=0,s=o=0,r=e.length;0<=r?o<r:o>r;s=0<=r?++o:--o)i+=e[s];return this.renderer.add({type:c.Type.Kernel,name:t,adjust:e,divisor:i,bias:n||0}),this},i.prototype.processPlugin=function(t,e){return this.renderer.add({type:c.Type.Plugin,plugin:t,args:e}),this},i.prototype.newLayer=function(t){var e;return e=new p(this),this.canvasQueue.push(e),this.renderer.add({type:c.Type.LayerDequeue}),t.call(e),this.renderer.add({type:c.Type.LayerFinished}),this},i.prototype.executeLayer=function(t){return this.pushContext(t)},i.prototype.pushContext=function(t){return this.layerStack.push(this.currentLayer),this.pixelStack.push(this.pixelData),this.currentLayer=t,this.pixelData=t.pixelData},i.prototype.popContext=function(){return this.pixelData=this.pixelStack.pop(),this.currentLayer=this.layerStack.pop()},i.prototype.applyCurrentLayer=function(){return this.currentLayer.applyToParent()},i}(),e=function(){function t(t){this.c=t}return t.prototype.calculateLevels=function(){var t,e,i,n,s,o,r;for(e={r:{},g:{},b:{}},t=n=0;n<=255;t=++n)e.r[t]=0,e.g[t]=0,e.b[t]=0;for(t=s=0,r=this.c.pixelData.length;s<r;t=s+=4)e.r[this.c.pixelData[t]]++,e.g[this.c.pixelData[t+1]]++,e.b[this.c.pixelData[t+2]]++;for(i=this.c.pixelData.length/4,t=o=0;o<=255;t=++o)e.r[t]/=i,e.g[t]/=i,e.b[t]/=i;return e},t}(),s.DOMUpdated=function(){var t,e,i,n,s;if((e=document.querySelectorAll("img[data-caman]")).length>0){for(s=[],i=0,n=e.length;i<n;i++)t=e[i],s.push(new o(t,function(){return this.parse(),this.execute()}));return s}},s.autoload&&("complete"===document.readyState?s.DOMUpdated():document.addEventListener("DOMContentLoaded",s.DOMUpdated,!1)),o=function(){function t(t,e){this.dataStr=t.getAttribute("data-caman"),this.caman=s(t,e.bind(this))}return"(\\w+)\\((.*?)\\)",t.prototype.parse=function(){var t,e,i,n,s,o,r,a,h,l;if(this.ele=this.caman.canvas,s=new RegExp("(\\w+)\\((.*?)\\)","g"),(o=this.dataStr.match(s)).length>0){for(s=new RegExp("(\\w+)\\((.*?)\\)"),l=[],r=0,a=o.length;r<a;r++){(h=o[r].match(s))[0],e=h[1],t=h[2],n=new Function("return function() {        this."+e+"("+t+");      };");try{i=n(),l.push(i.call(this.caman))}catch(t){l.push(f.debug(t))}}return l}},t.prototype.execute=function(){var t;return t=this.ele,this.caman.render(function(){return t.parentNode.replaceChild(this.toImage(),t)})},t}(),s.Blender=i=function(){function t(){}return t.blenders={},t.register=function(t,e){return this.blenders[t]=e},t.execute=function(t,e,i){return this.blenders[t](e,i)},t}(),s.Calculate=n=function(){function t(){}return t.distance=function(t,e,i,n){return Math.sqrt(Math.pow(i-t,2)+Math.pow(n-e,2))},t.randomRange=function(t,e,i){var n;return null==i&&(i=!1),n=t+Math.random()*(e-t),i?n.toFixed(i):Math.round(n)},t.luminance=function(t){return.299*t.r+.587*t.g+.114*t.b},t.bezier=function(t,e,i,n,s,o){var r,a,h,l,c,d,u,p,f,g,m,v,y,b,x,w,C,I,D,T,$,E,S,k,R,B,L;for(x=t[0],D=t[1],w=e[0],T=e[1],C=i[0],$=i[1],I=n[0],E=n[1],u={},r=I-x-(c=parseInt(3*(w-x),10))-(h=3*(C-w)-c),a=E-D-(d=3*(T-D))-(l=3*($-T)-d),g=S=0;S<1e3;g=++S)b=g/1e3,p=Math.round(r*Math.pow(b,3)+h*Math.pow(b,2)+c*b+x),f=Math.round(a*Math.pow(b,3)+l*Math.pow(b,2)+d*b+D),s&&f<s?f=s:o&&f>o&&(f=o),u[p]=f;if(u.length<n[0]+1)for(g=k=0,B=n[0];0<=B?k<=B:k>=B;g=0<=B?++k:--k)if(null==u[g]){for(v=[g-1,u[g-1]],m=R=g,L=n[0];g<=L?R<=L:R>=L;m=g<=L?++R:--R)if(null!=u[m]){y=[m,u[m]];break}u[g]=v[1]+(y[1]-v[1])/(y[0]-v[0])*(g-v[0])}return null==u[n[0]]&&(u[n[0]]=u[n[0]-1]),u},t}(),a=function(){function t(){}return t.hexToRGB=function(t){var e,i,n;return"#"===t.charAt(0)&&(t=t.substr(1)),n=parseInt(t.substr(0,2),16),i=parseInt(t.substr(2,2),16),e=parseInt(t.substr(4,2),16),{r:n,g:i,b:e}},t.rgbToHSL=function(t,e,i){var n,s,o,r,a,h;return"object"==typeof t&&(e=t.g,i=t.b,t=t.r),t/=255,e/=255,i/=255,r=Math.max(t,e,i),a=Math.min(t,e,i),o=(r+a)/2,r===a?s=h=0:(n=r-a,h=o>.5?n/(2-r-a):n/(r+a),s=function(){switch(r){case t:return(e-i)/n+(e<i?6:0);case e:return(i-t)/n+2;case i:return(t-e)/n+4}}(),s/=6),{h:s,s:h,l:o}},t.hslToRGB=function(t,e,i){var n,s,o,r,a;return"object"==typeof t&&(e=t.s,i=t.l,t=t.h),0===e?a=s=n=i:(o=2*i-(r=i<.5?i*(1+e):i+e-i*e),a=this.hueToRGB(o,r,t+1/3),s=this.hueToRGB(o,r,t),n=this.hueToRGB(o,r,t-1/3)),{r:255*a,g:255*s,b:255*n}},t.hueToRGB=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t},t.rgbToHSV=function(t,e,i){var n,s,o,r,a,h;return t/=255,e/=255,i/=255,o=Math.max(t,e,i),r=Math.min(t,e,i),h=o,n=o-r,a=0===o?0:n/o,o===r?s=0:(s=function(){switch(o){case t:return(e-i)/n+(e<i?6:0);case e:return(i-t)/n+2;case i:return(t-e)/n+4}}(),s/=6),{h:s,s:a,v:h}},t.hsvToRGB=function(t,e,i){var n,s,o,r,a,h,l,c;switch(r=Math.floor(6*t),s=6*t-r,a=i*(1-e),h=i*(1-s*e),c=i*(1-(1-s)*e),r%6){case 0:l=i,o=c,n=a;break;case 1:l=h,o=i,n=a;break;case 2:l=a,o=i,n=c;break;case 3:l=a,o=h,n=i;break;case 4:l=c,o=a,n=i;break;case 5:l=i,o=a,n=h}return{r:255*l,g:255*o,b:255*n}},t.rgbToXYZ=function(t,e,i){var n,s,o;return t/=255,e/=255,i/=255,t>.04045?t=Math.pow((t+.055)/1.055,2.4):t/=12.92,e>.04045?e=Math.pow((e+.055)/1.055,2.4):e/=12.92,i>.04045?i=Math.pow((i+.055)/1.055,2.4):i/=12.92,n=.4124*t+.3576*e+.1805*i,s=.2126*t+.7152*e+.0722*i,o=.0193*t+.1192*e+.9505*i,{x:100*n,y:100*s,z:100*o}},t.xyzToRGB=function(t,e,i){var n,s,o;return t/=100,e/=100,i/=100,o=3.2406*t+-1.5372*e+-.4986*i,s=-.9689*t+1.8758*e+.0415*i,n=.0557*t+-.204*e+1.057*i,o>.0031308?o=1.055*Math.pow(o,.4166666667)-.055:o*=12.92,s>.0031308?s=1.055*Math.pow(s,.4166666667)-.055:s*=12.92,n>.0031308?n=1.055*Math.pow(n,.4166666667)-.055:n*=12.92,{r:255*o,g:255*s,b:255*n}},t.xyzToLab=function(t,e,i){var n,s,o;return"object"==typeof t&&(e=t.y,i=t.z,t=t.x),95.047,100,108.883,t/=95.047,e/=100,i/=108.883,t=t>.008856451679?Math.pow(t,.3333333333):7.787037037*t+.1379310345,e=e>.008856451679?Math.pow(e,.3333333333):7.787037037*e+.1379310345,i=i>.008856451679?Math.pow(i,.3333333333):7.787037037*i+.1379310345,o=116*e-16,n=500*(t-e),s=200*(e-i),{l:o,a:n,b:s}},t.labToXYZ=function(t,e,i){var n,s,o;return"object"==typeof t&&(e=t.a,i=t.b,t=t.l),s=(t+16)/116,n=s+e/500,o=s-i/200,n>.2068965517?n*=n*n:n=.1284185493*(n-.1379310345),s>.2068965517?s*=s*s:s=.1284185493*(s-.1379310345),o>.2068965517?o*=o*o:o=.1284185493*(o-.1379310345),{x:95.047*n,y:100*s,z:108.883*o}},t.rgbToLab=function(t,e,i){var n;return"object"==typeof t&&(e=t.g,i=t.b,t=t.r),n=this.rgbToXYZ(t,e,i),this.xyzToLab(n)},t.labToRGB=function(t,e,i){},t}(),h=function(){function t(){}return t.events={},t.types=["processStart","processComplete","renderStart","renderFinished","blockStarted","blockFinished"],t.trigger=function(t,e,i){var n,s,o,r,a;if(this.events[e]&&this.events[e].length){for(a=[],s=0,o=(r=this.events[e]).length;s<o;s++)null===(n=r[s]).target||t.id===n.target.id?a.push(n.fn.call(t,i)):a.push(void 0);return a}},t.listen=function(t,e,i){var n,s;return"string"==typeof t&&(s=t,n=e,t=null,e=s,i=n),!($.call(this.types,e)<0)&&(this.events[e]||(this.events[e]=[]),this.events[e].push({target:t,fn:i}),!0)},t}(),s.Event=h,s.Filter=c=function(){function t(){}return t.Type={Single:1,Kernel:2,LayerDequeue:3,LayerFinished:4,LoadOverlay:5,Plugin:6},t.register=function(t,e){return s.prototype[t]=e},t}(),s.IO=d=function(){function t(){}return t.domainRegex=/(?:(?:http|https):\/\/)((?:\w+)\.(?:(?:\w|\.)+))/,t.isRemote=function(t){return null!=t&&(!this.corsEnabled(t)&&this.isURLRemote(t.src))},t.corsEnabled=function(t){var e;return null!=t.crossOrigin&&("anonymous"===(e=t.crossOrigin.toLowerCase())||"use-credentials"===e)},t.isURLRemote=function(t){var e;return!!(e=t.match(this.domainRegex))&&e[1]!==document.domain},t.remoteCheck=function(t){if(this.isURLRemote(t)){if(s.remoteProxy.length)return s.isURLRemote(s.remoteProxy)?void f.info("Cannot use a remote proxy for loading images."):s.remoteProxy+"?camanProxyUrl="+encodeURIComponent(t);f.info("Attempting to load a remote image without a configured proxy. URL: "+t)}},t.proxyUrl=function(t){return s.remoteProxy+"?"+s.proxyParam+"="+encodeURIComponent(t)},t.useProxy=function(t){var e;return e={ruby:"rb",python:"py",perl:"pl",javascript:"js"},t=t.toLowerCase(),null!=e[t]&&(t=e[t]),"proxies/caman_proxy."+t},t}(),s.prototype.save=function(){return"undefined"!=typeof exports&&null!==exports?this.nodeSave.apply(this,arguments):this.browserSave.apply(this,arguments)},s.prototype.browserSave=function(t){var e;return null==t&&(t="png"),t=t.toLowerCase(),e=this.toBase64(t).replace("image/"+t,"image/octet-stream"),document.location.href=e},s.prototype.nodeSave=function(t,e){null==e&&(e=!0);try{if(C.statSync(t).isFile()&&!e)return!1}catch(e){f.debug("Creating output file "+t)}return C.writeFile(t,this.canvas.toBuffer(),function(){return f.debug("Finished writing to "+t)})},s.prototype.toImage=function(t){var e;return e=document.createElement("img"),e.src=this.toBase64(t),e.width=this.dimensions.width,e.height=this.dimensions.height,window.devicePixelRatio&&(e.width/=window.devicePixelRatio,e.height/=window.devicePixelRatio),e},s.prototype.toBase64=function(t){return null==t&&(t="png"),t=t.toLowerCase(),this.canvas.toDataURL("image/"+t)},p=function(){function e(t){this.c=t,this.filter=this.c,this.options={blendingMode:"normal",opacity:1},this.layerID=w.uniqid.get(),this.canvas="undefined"!=typeof exports&&null!==exports?new r:document.createElement("canvas"),this.canvas.width=this.c.dimensions.width,this.canvas.height=this.c.dimensions.height,this.context=this.canvas.getContext("2d"),this.context.createImageData(this.canvas.width,this.canvas.height),this.imageData=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),this.pixelData=this.imageData.data}return e.prototype.newLayer=function(t){return this.c.newLayer.call(this.c,t)},e.prototype.setBlendingMode=function(t){return this.options.blendingMode=t,this},e.prototype.opacity=function(t){return this.options.opacity=t/100,this},e.prototype.copyParent=function(){var t,e,i,n;for(e=this.c.pixelData,t=i=0,n=this.c.pixelData.length;i<n;t=i+=4)this.pixelData[t]=e[t],this.pixelData[t+1]=e[t+1],this.pixelData[t+2]=e[t+2],this.pixelData[t+3]=e[t+3];return this},e.prototype.fillColor=function(){return this.c.fillColor.apply(this.c,arguments)},e.prototype.overlayImage=function(e){return"object"==typeof e?e=e.src:"string"==typeof e&&"#"===e[0]&&(e=t(e).src),e?(this.c.renderer.renderQueue.push({type:c.Type.LoadOverlay,src:e,layer:this}),this):this},e.prototype.applyToParent=function(){var t,e,n,s,o,r,a,h,l;for(n=this.c.pixelStack[this.c.pixelStack.length-1],l=[],t=a=0,h=(e=this.c.pixelData).length;a<h;t=a+=4)r={r:n[t],g:n[t+1],b:n[t+2],a:n[t+3]},o={r:e[t],g:e[t+1],b:e[t+2],a:e[t+3]},(s=i.execute(this.options.blendingMode,o,r)).r=w.clampRGB(s.r),s.g=w.clampRGB(s.g),s.b=w.clampRGB(s.b),null==s.a&&(s.a=o.a),n[t]=r.r-(r.r-s.r)*(this.options.opacity*(s.a/255)),n[t+1]=r.g-(r.g-s.g)*(this.options.opacity*(s.a/255)),l.push(n[t+2]=r.b-(r.b-s.b)*(this.options.opacity*(s.a/255)));return l},e}(),g=function(){return function(){var t,e,i,n;for(e=0,i=(n=["log","info","warn","error"]).length;e<i;e++)this[t=n[e]]=function(t){return function(){var e;if(e=1<=arguments.length?E.call(arguments,0):[],s.DEBUG)try{return console[t].apply(console,e)}catch(i){return console[t](e)}}}(t);this.debug=this.log}}(),f=new g,m=function(){function t(t){this.c=t,this.loc=0}return t.coordinatesToLocation=function(t,e,i){return 4*(e*i+t)},t.locationToCoordinates=function(t,e){var i,n;return n=Math.floor(t/(4*e)),i=t%(4*e)/4,{x:i,y:n}},t.prototype.locationXY=function(){var t,e;return e=this.c.dimensions.height-Math.floor(this.loc/(4*this.c.dimensions.width)),t=this.loc%(4*this.c.dimensions.width)/4,{x:t,y:e}},t.prototype.getPixelRelative=function(t,e){var i;return(i=this.loc+4*this.c.dimensions.width*(-1*e)+4*t)>this.c.pixelData.length||i<0?{r:0,g:0,b:0,a:0}:{r:this.c.pixelData[i],g:this.c.pixelData[i+1],b:this.c.pixelData[i+2],a:this.c.pixelData[i+3]}},t.prototype.putPixelRelative=function(t,e,i){if(this.loc+4*this.c.dimensions.width*(-1*e)+4*t,!(newLoc>this.c.pixelData.length||newLoc<0))return this.c.pixelData[newLoc]=i.r,this.c.pixelData[newLoc+1]=i.g,this.c.pixelData[newLoc+2]=i.b,this.c.pixelData[newLoc+3]=i.a,!0},t.prototype.getPixel=function(t,e){var i;return i=this.coordinatesToLocation(t,e,this.width),{r:this.c.pixelData[i],g:this.c.pixelData[i+1],b:this.c.pixelData[i+2],a:this.c.pixelData[i+3]}},t.prototype.putPixel=function(t,e,i){var n;return n=this.coordinatesToLocation(t,e,this.width),this.c.pixelData[n]=i.r,this.c.pixelData[n+1]=i.g,this.c.pixelData[n+2]=i.b,this.c.pixelData[n+3]=i.a},t}(),v=function(){function t(){}return t.plugins={},t.register=function(t,e){return this.plugins[t]=e},t.execute=function(t,e,i){return this.plugins[e].apply(t,i)},t}(),s.Plugin=v,s.Renderer=y=function(){function t(e){var i=this;this.c=e,this.processNext=function(){return t.prototype.processNext.apply(i,arguments)},this.renderQueue=[],this.modPixelData=null}return t.Blocks=s.NodeJS?require("os").cpus().length:4,t.prototype.add=function(t){if(null!=t)return this.renderQueue.push(t)},t.prototype.processNext=function(){var t;if(0===this.renderQueue.length)return h.trigger(this,"renderFinished"),null!=this.finishedFn&&this.finishedFn.call(this.c),this;switch(this.currentJob=this.renderQueue.shift(),this.currentJob.type){case c.Type.LayerDequeue:return t=this.c.canvasQueue.shift(),this.c.executeLayer(t),this.processNext();case c.Type.LayerFinished:return this.c.applyCurrentLayer(),this.c.popContext(),this.processNext();case c.Type.LoadOverlay:return this.loadOverlay(this.currentJob.layer,this.currentJob.src);case c.Type.Plugin:return this.executePlugin();default:return this.executeFilter()}},t.prototype.execute=function(t){return this.finishedFn=t,this.modPixelData=w.dataArray(this.c.pixelData.length),this.processNext()},t.prototype.eachBlock=function(e){var i,n,o,r,a,h,c,d,u,p,f=this;for(this.blocksDone=0,h=this.c.pixelData.length,a=(i=4*Math.floor(h/4/t.Blocks))+h/4%t.Blocks*4,p=[],r=d=0,u=t.Blocks;0<=u?d<u:d>u;r=0<=u?++d:--d)o=(c=r*i)+(r===t.Blocks-1?a:i),s.NodeJS?(n=l(function(){return e.call(f,r,c,o)}).run(),p.push(this.blockFinished(n))):p.push(setTimeout(function(t,i,n){return function(){return e.call(f,t,i,n)}}(r,c,o),0));return p},t.prototype.executeFilter=function(){return h.trigger(this.c,"processStart",this.currentJob),this.currentJob.type===c.Type.Single?this.eachBlock(this.renderBlock):this.eachBlock(this.renderKernel)},t.prototype.executePlugin=function(){return f.debug("Executing plugin "+this.currentJob.plugin),v.execute(this.c,this.currentJob.plugin,this.currentJob.args),f.debug("Plugin "+this.currentJob.plugin+" finished!"),this.processNext()},t.prototype.renderBlock=function(e,i,n){var o,r,a,c,d;for(f.debug("Block #"+e+" - Filter: "+this.currentJob.name+", Start: "+i+", End: "+n),h.trigger(this.c,"blockStarted",{blockNum:e,totalBlocks:t.Blocks,startPixel:i,endPixel:n}),o={r:0,g:0,b:0,a:0},a=new m(this.c),r=d=i;d<n;r=d+=4)a.loc=r,o.r=this.c.pixelData[r],o.g=this.c.pixelData[r+1],o.b=this.c.pixelData[r+2],o.a=this.c.pixelData[r+3],null==(c=this.currentJob.processFn.call(a,o)).a&&(c.a=o.a),this.c.pixelData[r]=w.clampRGB(c.r),this.c.pixelData[r+1]=w.clampRGB(c.g),this.c.pixelData[r+2]=w.clampRGB(c.b),this.c.pixelData[r+3]=w.clampRGB(c.a);return s.NodeJS?l.yield(e):this.blockFinished(e)},t.prototype.renderKernel=function(t,e,i){var n,o,r,a,h,c,d,u,p,g,v,y,b,x,C,I,D;for(this.currentJob.name,r=this.currentJob.bias,c=this.currentJob.divisor,v=this.c.pixelData.length,n=this.currentJob.adjust,o=Math.sqrt(n.length),g=[],f.debug("Rendering kernel - Filter: "+this.currentJob.name),e=Math.max(e,4*this.c.dimensions.width*((o-1)/2)),i=Math.min(i,v-4*this.c.dimensions.width*((o-1)/2)),a=(o-1)/2,b=new m(this.c),d=C=e;C<i;d=C+=4){for(b.loc=d,h=0,u=I=-a;-a<=a?I<=a:I>=a;u=-a<=a?++I:--I)for(p=D=a;a<=-a?D<=-a:D>=-a;p=a<=-a?++D:--D)y=b.getPixelRelative(u,p),g[3*h]=y.r,g[3*h+1]=y.g,g[3*h+2]=y.b,h++;x=this.processKernel(n,g,c,r),this.modPixelData[d]=w.clampRGB(x.r),this.modPixelData[d+1]=w.clampRGB(x.g),this.modPixelData[d+2]=w.clampRGB(x.b),this.modPixelData[d+3]=this.c.pixelData[d+3]}return s.NodeJS?l.yield(t):this.blockFinished(t)},t.prototype.blockFinished=function(e){var i,n,s;if(e>=0&&f.debug("Block #"+e+" finished! Filter: "+this.currentJob.name),this.blocksDone++,h.trigger(this.c,"blockFinished",{blockNum:e,blocksFinished:this.blocksDone,totalBlocks:t.Blocks}),this.blocksDone===t.Blocks){if(this.currentJob.type===c.Type.Kernel)for(i=n=0,s=this.c.pixelData.length;0<=s?n<s:n>s;i=0<=s?++n:--n)this.c.pixelData[i]=this.modPixelData[i];return e>=0&&f.debug("Filter "+this.currentJob.name+" finished!"),h.trigger(this.c,"processComplete",this.currentJob),this.processNext()}},t.prototype.processKernel=function(t,e,i,n){var s,o,r,a;for(o={r:0,g:0,b:0},s=r=0,a=t.length;0<=a?r<a:r>a;s=0<=a?++r:--r)o.r+=t[s]*e[3*s],o.g+=t[s]*e[3*s+1],o.b+=t[s]*e[3*s+2];return o.r=o.r/i+n,o.g=o.g/i+n,o.b=o.b/i+n,o},t.prototype.loadOverlay=function(t,e){var i,n,s=this;return i=document.createElement("img"),i.onload=function(){return t.context.drawImage(i,0,0,s.c.dimensions.width,s.c.dimensions.height),t.imageData=t.context.getImageData(0,0,s.c.dimensions.width,s.c.dimensions.height),t.pixelData=t.imageData.data,s.c.pixelData=t.pixelData,s.processNext()},n=d.remoteCheck(e),i.src=null!=n?n:e},t}(),s.Store=x=function(){function t(){}return t.items={},t.has=function(t){return null!=this.items[t]},t.get=function(t){return this.items[t]},t.put=function(t,e){return this.items[t]=e},t.execute=function(t,e){var i=this;return setTimeout(function(){return e.call(i.get(t),i.get(t))},0),this.get(t)},t.flush=function(t){return null==t&&(t=!1),t?delete this.items[t]:this.items={}},t}(),i.register("normal",function(t,e){return{r:t.r,g:t.g,b:t.b}}),i.register("multiply",function(t,e){return{r:t.r*e.r/255,g:t.g*e.g/255,b:t.b*e.b/255}}),i.register("screen",function(t,e){return{r:255-(255-t.r)*(255-e.r)/255,g:255-(255-t.g)*(255-e.g)/255,b:255-(255-t.b)*(255-e.b)/255}}),i.register("overlay",function(t,e){var i;return i={},i.r=e.r>128?255-2*(255-t.r)*(255-e.r)/255:e.r*t.r*2/255,i.g=e.g>128?255-2*(255-t.g)*(255-e.g)/255:e.g*t.g*2/255,i.b=e.b>128?255-2*(255-t.b)*(255-e.b)/255:e.b*t.b*2/255,i}),i.register("difference",function(t,e){return{r:t.r-e.r,g:t.g-e.g,b:t.b-e.b}}),i.register("addition",function(t,e){return{r:e.r+t.r,g:e.g+t.g,b:e.b+t.b}}),i.register("exclusion",function(t,e){return{r:128-2*(e.r-128)*(t.r-128)/255,g:128-2*(e.g-128)*(t.g-128)/255,b:128-2*(e.b-128)*(t.b-128)/255}}),i.register("softLight",function(t,e){var i;return i={},i.r=e.r>128?255-(255-e.r)*(255-(t.r-128))/255:e.r*(t.r+128)/255,i.g=e.g>128?255-(255-e.g)*(255-(t.g-128))/255:e.g*(t.g+128)/255,i.b=e.b>128?255-(255-e.b)*(255-(t.b-128))/255:e.b*(t.b+128)/255,i}),i.register("lighten",function(t,e){return{r:e.r>t.r?e.r:t.r,g:e.g>t.g?e.g:t.g,b:e.b>t.b?e.b:t.b}}),i.register("darken",function(t,e){return{r:e.r>t.r?t.r:e.r,g:e.g>t.g?t.g:e.g,b:e.b>t.b?t.b:e.b}}),c.register("fillColor",function(){var t;return t=1===arguments.length?a.hexToRGB(arguments[0]):{r:arguments[0],g:arguments[1],b:arguments[2]},this.process("fillColor",function(e){return e.r=t.r,e.g=t.g,e.b=t.b,e.a=255,e})}),c.register("brightness",function(t){return t=Math.floor(t/100*255),this.process("brightness",function(e){return e.r+=t,e.g+=t,e.b+=t,e})}),c.register("saturation",function(t){return t*=-.01,this.process("saturation",function(e){var i;return i=Math.max(e.r,e.g,e.b),e.r!==i&&(e.r+=(i-e.r)*t),e.g!==i&&(e.g+=(i-e.g)*t),e.b!==i&&(e.b+=(i-e.b)*t),e})}),c.register("vibrance",function(t){return t*=-1,this.process("vibrance",function(e){var i,n,s;return s=Math.max(e.r,e.g,e.b),n=(e.r+e.g+e.b)/3,i=2*Math.abs(s-n)/255*t/100,e.r!==s&&(e.r+=(s-e.r)*i),e.g!==s&&(e.g+=(s-e.g)*i),e.b!==s&&(e.b+=(s-e.b)*i),e})}),c.register("greyscale",function(t){return this.process("greyscale",function(t){var e;return e=n.luminance(t),t.r=e,t.g=e,t.b=e,t})}),c.register("contrast",function(t){return t=Math.pow((t+100)/100,2),this.process("contrast",function(e){return e.r/=255,e.r-=.5,e.r*=t,e.r+=.5,e.r*=255,e.g/=255,e.g-=.5,e.g*=t,e.g+=.5,e.g*=255,e.b/=255,e.b-=.5,e.b*=t,e.b+=.5,e.b*=255,e})}),c.register("hue",function(t){return this.process("hue",function(e){var i,n,s;return n=a.rgbToHSV(e.r,e.g,e.b),i=100*n.h,i+=Math.abs(t),i%=100,i/=100,n.h=i,s=a.hsvToRGB(n.h,n.s,n.v),s.a=e.a,s})}),c.register("colorize",function(){var t,e;return 2===arguments.length?(e=a.hexToRGB(arguments[0]),t=arguments[1]):4===arguments.length&&(e={r:arguments[0],g:arguments[1],b:arguments[2]},t=arguments[3]),this.process("colorize",function(i){return i.r-=(i.r-e.r)*(t/100),i.g-=(i.g-e.g)*(t/100),i.b-=(i.b-e.b)*(t/100),i})}),c.register("invert",function(){return this.process("invert",function(t){return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,t})}),c.register("sepia",function(t){return null==t&&(t=100),t/=100,this.process("sepia",function(e){return e.r=Math.min(255,e.r*(1-.607*t)+e.g*(.769*t)+e.b*(.189*t)),e.g=Math.min(255,e.r*(.349*t)+e.g*(1-.314*t)+e.b*(.168*t)),e.b=Math.min(255,e.r*(.272*t)+e.g*(.534*t)+e.b*(1-.869*t)),e})}),c.register("gamma",function(t){return this.process("gamma",function(e){return e.r=255*Math.pow(e.r/255,t),e.g=255*Math.pow(e.g/255,t),e.b=255*Math.pow(e.b/255,t),e})}),c.register("noise",function(t){return t=2.55*Math.abs(t),this.process("noise",function(e){var i;return i=n.randomRange(-1*t,t),e.r+=i,e.g+=i,e.b+=i,e})}),c.register("clip",function(t){return t=2.55*Math.abs(t),this.process("clip",function(e){return e.r>255-t?e.r=255:e.r<t&&(e.r=0),e.g>255-t?e.g=255:e.g<t&&(e.g=0),e.b>255-t?e.b=255:e.b<t&&(e.b=0),e})}),c.register("channels",function(t){var e;if("object"!=typeof t)return this;for(e in t)T.call(t,e)&&(0!==t[e]?t[e]/=100:delete t[e]);return 0===t.length?this:this.process("channels",function(e){return null!=t.red&&(t.red>0?e.r+=(255-e.r)*t.red:e.r-=e.r*Math.abs(t.red)),null!=t.green&&(t.green>0?e.g+=(255-e.g)*t.green:e.g-=e.g*Math.abs(t.green)),null!=t.blue&&(t.blue>0?e.b+=(255-e.b)*t.blue:e.b-=e.b*Math.abs(t.blue)),e})}),c.register("curves",function(){var t,e,i,s,o,r,a,h,l,c,d,u;if(e=arguments[0],i=2<=arguments.length?E.call(arguments,1):[],"string"==typeof e&&(e=e.split("")),"v"===e[0]&&(e=["r","g","b"]),i.length<3||i.length>4)throw"Invalid number of arguments to curves filter";if(h=i[0],s=i[1],o=4===i.length?i[2]:i[1],r=i[i.length-1],t=n.bezier(h,s,o,r,0,255),h[0]>0)for(a=l=0,d=h[0];0<=d?l<d:l>d;a=0<=d?++l:--l)t[a]=h[1];if(r[0]<255)for(a=c=u=r[0];u<=255?c<=255:c>=255;a=u<=255?++c:--c)t[a]=r[1];return this.process("curves",function(i){var n,s;for(a=n=0,s=e.length;0<=s?n<s:n>s;a=0<=s?++n:--n)i[e[a]]=t[i[e[a]]];return i})}),c.register("exposure",function(t){var e,i,n;return n=Math.abs(t)/100,e=[0,255*n],i=[255-255*n,255],t<0&&(e=e.reverse(),i=i.reverse()),this.curves("rgb",[0,0],e,i,[255,255])}),s.Plugin.register("crop",function(t,e,i,n){var s;return null==i&&(i=0),null==n&&(n=0),"undefined"!=typeof exports&&null!==exports?s=new r(t,e):(s=document.createElement("canvas"),w.copyAttributes(this.canvas,s),s.width=t,s.height=e),s.getContext("2d").drawImage(this.canvas,i,n,t,e,0,0,t,e),this.cropCoordinates={x:i,y:n},this.cropped=!0,this.replaceCanvas(s)}),s.Plugin.register("resize",function(t){var e;null==t&&(t=null);{if(null!==t&&(null!=t.width||null!=t.height))return null==t.width?t.width=this.canvas.width*t.height/this.canvas.height:null==t.height&&(t.height=this.canvas.height*t.width/this.canvas.width),"undefined"!=typeof exports&&null!==exports?e=new r(t.width,t.height):(e=document.createElement("canvas"),w.copyAttributes(this.canvas,e),e.width=t.width,e.height=t.height),e.getContext("2d").drawImage(this.canvas,0,0,this.canvas.width,this.canvas.height,0,0,t.width,t.height),this.resized=!0,this.replaceCanvas(e);f.error("Invalid or missing dimensions given for resize")}}),s.Filter.register("crop",function(){return this.processPlugin("crop",Array.prototype.slice.call(arguments,0))}),s.Filter.register("resize",function(){return this.processPlugin("resize",Array.prototype.slice.call(arguments,0))}),s.Filter.register("boxBlur",function(){return this.processKernel("Box Blur",[1,1,1,1,1,1,1,1,1])}),s.Filter.register("heavyRadialBlur",function(){return this.processKernel("Heavy Radial Blur",[0,0,1,0,0,0,1,1,1,0,1,1,1,1,1,0,1,1,1,0,0,0,1,0,0])}),s.Filter.register("gaussianBlur",function(){return this.processKernel("Gaussian Blur",[1,4,6,4,1,4,16,24,16,4,6,24,36,24,6,4,16,24,16,4,1,4,6,4,1])}),s.Filter.register("motionBlur",function(t){var e;return e=0===t||180===t?[0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0]:t>0&&t<90||t>180&&t<270?[0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0]:90===t||270===t?[0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0]:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],this.processKernel("Motion Blur",e)}),s.Filter.register("sharpen",function(t){return null==t&&(t=100),t/=100,this.processKernel("Sharpen",[0,-t,0,-t,4*t+1,-t,0,-t,0])}),D={brightness:function(t,e,i){return t.r=t.r-t.r*e*i.strength,t.g=t.g-t.g*e*i.strength,t.b=t.b-t.b*e*i.strength,t},gamma:function(t,e,i){return t.r=255*Math.pow(t.r/255,Math.max(10*e*i.strength,1)),t.g=255*Math.pow(t.g/255,Math.max(10*e*i.strength,1)),t.b=255*Math.pow(t.b/255,Math.max(10*e*i.strength,1)),t},colorize:function(t,e,i){return t.r-=(t.r-i.color.r)*e,t.g-=(t.g-i.color.g)*e,t.b-=(t.b-i.color.b)*e,t}},c.register("vignette",function(t,e){var i,s,o,r;return null==e&&(e=60),"string"==typeof t&&"%"===t.substr(-1)&&(t=this.dimensions.height>this.dimensions.width?this.dimensions.width*(parseInt(t.substr(0,t.length-1),10)/100):this.dimensions.height*(parseInt(t.substr(0,t.length-1),10)/100)),e/=100,s=[this.dimensions.width/2,this.dimensions.height/2],r=Math.sqrt(Math.pow(s[0],2)+Math.pow(s[1],2)),o=r-t,i=n.bezier([0,1],[30,30],[70,60],[100,80]),this.process("vignette",function(r){var a,h,l;return l=this.locationXY(),(a=n.distance(l.x,l.y,s[0],s[1]))>o&&(h=Math.max(1,i[Math.round((a-o)/t*100)]/10*e),r.r=255*Math.pow(r.r/255,h),r.g=255*Math.pow(r.g/255,h),r.b=255*Math.pow(r.b/255,h)),r})}),c.register("rectangularVignette",function(t){var e,i,o,r,h,l,c;if(e={strength:50,cornerRadius:0,method:"brightness",color:{r:0,g:0,b:0}},!(t=w.extend(e,t)).size)return this;if("string"==typeof t.size)o=parseInt(t.size,10)/100,t.size={width:this.dimensions.width*o,height:this.dimensions.height*o};else if("object"==typeof t.size)for(h=0,l=(c=["width","height"]).length;h<l;h++)i=c[h],"string"==typeof t.size[i]&&(t.size[i]=this.dimensions[i]*(parseInt(t.size[i],10)/100));else"number"===t.size&&(r=t.size,t.size={width:r,height:r});return"string"==typeof t.cornerRadius&&(t.cornerRadius=t.size.width/2*(parseInt(t.cornerRadius,10)/100)),t.strength/=100,t.size.width=Math.floor(t.size.width),t.size.height=Math.floor(t.size.height),t.image={width:this.dimensions.width,height:this.dimensions.height},"colorize"===t.method&&"string"==typeof t.color&&(t.color=a.hexToRGB(t.color)),t.coords={left:(this.dimensions.width-t.size.width)/2,right:this.dimensions.width-t.coords.left,bottom:(this.dimensions.height-t.size.height)/2,top:this.dimensions.height-t.coords.bottom},t.corners=[{x:t.coords.left+t.cornerRadius,y:t.coords.top-t.cornerRadius},{x:t.coords.right-t.cornerRadius,y:t.coords.top-t.cornerRadius},{x:t.coords.right-t.cornerRadius,y:t.coords.bottom+t.cornerRadius},{x:t.coords.left+t.cornerRadius,y:t.coords.bottom+t.cornerRadius}],t.maxDist=n.distance(0,0,t.corners[3].x,t.corners[3].y)-t.cornerRadius,this.process("rectangularVignette",function(e){var i,n;return(n=this.locationXY()).x>t.corners[0].x&&n.x<t.corners[1].x&&n.y>t.coords.bottom&&n.y<t.coords.top?e:n.x>t.coords.left&&n.x<t.coords.right&&n.y>t.corners[3].y&&n.y<t.corners[2].y?e:(n.x>t.corners[0].x&&n.x<t.corners[1].x&&n.y>t.coords.top?i=(n.y-t.coords.top)/t.maxDist:n.y>t.corners[2].y&&n.y<t.corners[1].y&&n.x>t.coords.right?i=(n.x-t.coords.right)/t.maxDist:n.x>t.corners[0].x&&n.x<t.corners[1].x&&n.y<t.coords.bottom?i=(t.coords.bottom-n.y)/t.maxDist:n.y>t.corners[2].y&&n.y<t.corners[1].y&&n.x<t.coords.left?i=(t.coords.left-n.x)/t.maxDist:n.x<=t.corners[0].x&&n.y>=t.corners[0].y?i=(s.distance(n.x,n.y,t.corners[0].x,t.corners[0].y)-t.cornerRadius)/t.maxDist:n.x>=t.corners[1].x&&n.y>=t.corners[1].y?i=(s.distance(n.x,n.y,t.corners[1].x,t.corners[1].y)-t.cornerRadius)/t.maxDist:n.x>=t.corners[2].x&&n.y<=t.corners[2].y?i=(s.distance(n.x,n.y,t.corners[2].x,t.corners[2].y)-t.cornerRadius)/t.maxDist:n.x<=t.corners[3].x&&n.y<=t.corners[3].y&&(i=(s.distance(n.x,n.y,t.corners[3].x,t.corners[3].y)-t.cornerRadius)/t.maxDist),i<0?e:D[t.method](e,i,t))})}),function(){var t,e,i,n,o;n=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],o=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24],e=function(t,e,i,n,s,o,a){var h,l,c,d,u,p,f;return h="undefined"!=typeof exports&&null!==exports?new r:document.createElement("canvas"),h.width=t,h.height=e,d=i+Math.cos(s)*o*.5,p=n+Math.sin(s)*o*.5,u=i-Math.cos(s)*o*.5,f=n-Math.sin(s)*o*.5,l=h.getContext("2d"),c=l.createLinearGradient(d,p,u,f),a?(c.addColorStop(0,"white"),c.addColorStop(.5,"black"),c.addColorStop(1,"white")):(c.addColorStop(0,"white"),c.addColorStop(1,"black")),l.fillStyle=c,l.fillRect(0,0,t,e),l.getImageData(0,0,t,e)},i=function(t,e,i,n,s,o){var a,h,l;return a="undefined"!=typeof exports&&null!==exports?new r:document.createElement("canvas"),a.width=t,a.height=e,h=a.getContext("2d"),(l=h.createRadialGradient(i,n,s,i,n,o)).addColorStop(1,"white"),l.addColorStop(0,"black"),h.fillStyle=l,h.fillRect(0,0,t,e),h.getImageData(0,0,t,e)},t=function(){return this.r=0,this.g=0,this.b=0,this.a=0,this.next=null},s.Plugin.register("compoundBlur",function(e,i,s,r){var a,h,l,c,d,u,p,f,g,m,v,y,b,x,w,C,I,D,T,$,E,S,k,R,B,L,z,O,P,M,A,W,j,N,_,F,H,Y,X,U,Q,q,V,J,G,K,Z,tt,et,it,nt,st,ot,rt,at,ht,lt;for(Q=this.dimensions.width,m=this.dimensions.height,w=this.pixelData,O=e.data,U=(X=Q*m)<<2,k=[],y=tt=0;0<=U?tt<U:tt>U;y=0<=U?++tt:--tt)k[y]=w[y];for(d=0,H=r,r-=1;H-- >=0;)if(0!=(I=i+.5|0)){for(I>256&&(I=256),u=I+I+1,Q<<2,q=Q-1,v=m-1,Y=(P=I+1)*(P+1)/2,j=void 0,W=F=new t,y=et=1;1<=u?et<u:et>u;y=1<=u?++et:--et)W=W.next=new t,y===P&&(j=W);for(W.next=F,N=null,_=null,Z=G=0,T=n[I],A=o[I],J=it=0;0<=m?it<m:it>m;J=0<=m?++it:--it){for(B=p=a=z=g=l=0,L=P*(R=k[G]),f=P*(S=k[G+1]),h=P*(E=k[G+2]),z+=Y*R,g+=Y*S,l+=Y*E,W=F,y=nt=0;0<=P?nt<P:nt>P;y=0<=P?++nt:--nt)W.r=R,W.g=S,W.b=E,W=W.next;for(y=st=1;1<=P?st<P:st>P;y=1<=P?++st:--st)$=G+((q<y?q:y)<<2),z+=(W.r=R=k[$])*(M=P-y),g+=(W.g=S=k[$+1])*M,l+=(W.b=E=k[$+2])*M,B+=R,p+=S,a+=E,W=W.next;for(N=F,_=j,V=ot=0;0<=Q?ot<Q:ot>Q;V=0<=Q?++ot:--ot)k[G]=z*T>>A,k[G+1]=g*T>>A,k[G+2]=l*T>>A,z-=L,g-=f,l-=h,L-=N.r,f-=N.g,h-=N.b,$=Z+(($=V+P)<q?$:q)<<2,z+=B+=N.r=k[$],g+=p+=N.g=k[$+1],l+=a+=N.b=k[$+2],N=N.next,L+=R=_.r,f+=S=_.g,h+=E=_.b,B-=R,p-=S,a-=E,_=_.next,G+=4;Z+=Q}for(V=rt=0;0<=Q?rt<Q:rt>Q;V=0<=Q?++rt:--rt){for(p=a=B=g=l=z=0,L=P*(R=k[G=V<<2]),f=P*(S=k[G+1]),h=P*(E=k[G+2]),z+=Y*R,g+=Y*S,l+=Y*E,W=F,y=at=0;0<=P?at<P:at>P;y=0<=P?++at:--at)W.r=R,W.g=S,W.b=E,W=W.next;for(K=Q,y=ht=1;1<=P?ht<P:ht>P;y=1<=P?++ht:--ht)G=K+V<<2,z+=(W.r=R=k[G])*(M=P-y),g+=(W.g=S=k[G+1])*M,l+=(W.b=E=k[G+2])*M,B+=R,p+=S,a+=E,W=W.next,y<v&&(K+=Q);for(G=V,N=F,_=j,J=lt=0;0<=m?lt<m:lt>m;J=0<=m?++lt:--lt)k[$=G<<2]=z*T>>A,k[$+1]=g*T>>A,k[$+2]=l*T>>A,z-=L,g-=f,l-=h,L-=N.r,f-=N.g,h-=N.b,$=V+(($=J+P)<v?$:v)*Q<<2,z+=B+=N.r=k[$],g+=p+=N.g=k[$+1],l+=a+=N.b=k[$+2],N=N.next,L+=R=_.r,f+=S=_.g,h+=E=_.b,B-=R,p-=S,a-=E,_=_.next,G+=Q}for(i*=s,y=X;--y>-1;)(C=0|(D=(255&O[(x=y<<2)+2])/255*r))===d?(b=256-(c=256*(D-(0|D))),w[x]=w[x]*b+k[x]*c>>8,w[x+1]=w[x+1]*b+k[x+1]*c>>8,w[x+2]=w[x+2]*b+k[x+2]*c>>8):C===d+1&&(w[x]=k[x],w[x+1]=k[x+1],w[x+2]=k[x+2]);d++}return this}),s.Filter.register("tiltShift",function(t){var i,n;return i={center:{x:this.dimensions.width/2,y:this.dimensions.height/2},angle:45,focusWidth:200,startRadius:3,radiusFactor:1.5,steps:3},t=w.extend(i,t),t.angle*=Math.PI/180,n=e(this.dimensions.width,this.dimensions.height,t.center.x,t.center.y,t.angle,t.focusWidth,!0),this.processPlugin("compoundBlur",[n,t.startRadius,t.radiusFactor,t.steps])}),s.Filter.register("radialBlur",function(t){var e,n,s,o;return e={size:50,center:{x:this.dimensions.width/2,y:this.dimensions.height/2},startRadius:3,radiusFactor:1.5,steps:3,radius:null},(t=w.extend(e,t)).radius||(t.radius=this.dimensions.width<this.dimensions.height?this.dimensions.height:this.dimensions.width),s=t.radius/2-t.size,o=t.radius/2,n=i(this.dimensions.width,this.dimensions.height,t.center.x,t.center.y,s,o),this.processPlugin("compoundBlur",[n,t.startRadius,t.radiusFactor,t.steps])})}(),s.Filter.register("edgeEnhance",function(){return this.processKernel("Edge Enhance",[0,0,0,-1,1,0,0,0,0])}),s.Filter.register("edgeDetect",function(){return this.processKernel("Edge Detect",[-1,-1,-1,-1,8,-1,-1,-1,-1])}),s.Filter.register("emboss",function(){return this.processKernel("Emboss",[-2,-1,0,-1,1,1,0,1,2])}),s.Filter.register("posterize",function(t){var e,i;return e=256/t,i=255/(t-1),this.process("posterize",function(t){return t.r=Math.floor(Math.floor(t.r/e)*i),t.g=Math.floor(Math.floor(t.g/e)*i),t.b=Math.floor(Math.floor(t.b/e)*i),t})}),s.Filter.register("vintage",function(t){if(null==t&&(t=!0),this.greyscale(),this.contrast(5),this.noise(3),this.sepia(100),this.channels({red:8,blue:2,green:4}),this.gamma(.87),t)return this.vignette("40%",30)}),s.Filter.register("lomo",function(t){return null==t&&(t=!0),this.brightness(15),this.exposure(15),this.curves("rgb",[0,0],[200,0],[155,255],[255,255]),this.saturation(-20),this.gamma(1.8),t&&this.vignette("50%",60),this.brightness(5)}),s.Filter.register("clarity",function(t){return null==t&&(t=!1),this.vibrance(20),this.curves("rgb",[5,0],[130,150],[190,220],[250,255]),this.sharpen(15),this.vignette("45%",20),t&&(this.greyscale(),this.contrast(4)),this}),s.Filter.register("sinCity",function(){return this.contrast(100),this.brightness(15),this.exposure(10),this.posterize(80),this.clip(30),this.greyscale()}),s.Filter.register("sunrise",function(){return this.exposure(3.5),this.saturation(-5),this.vibrance(50),this.sepia(60),this.colorize("#e87b22",10),this.channels({red:8,blue:8}),this.contrast(5),this.gamma(1.2),this.vignette("55%",25)}),s.Filter.register("crossProcess",function(){return this.exposure(5),this.colorize("#e87b22",4),this.sepia(20),this.channels({blue:8,red:3}),this.curves("b",[0,0],[100,150],[180,180],[255,255]),this.contrast(15),this.vibrance(75),this.gamma(1.6)}),s.Filter.register("orangePeel",function(){return this.curves("rgb",[0,0],[100,50],[140,200],[255,255]),this.vibrance(-30),this.saturation(-30),this.colorize("#ff9000",30),this.contrast(-5),this.gamma(1.4)}),s.Filter.register("love",function(){return this.brightness(5),this.exposure(8),this.contrast(4),this.colorize("#c42007",30),this.vibrance(50),this.gamma(1.3)}),s.Filter.register("grungy",function(){return this.gamma(1.5),this.clip(25),this.saturation(-60),this.contrast(5),this.noise(5),this.vignette("50%",30)}),s.Filter.register("jarques",function(){return this.saturation(-35),this.curves("b",[20,0],[90,120],[186,144],[255,230]),this.curves("r",[0,0],[144,90],[138,120],[255,255]),this.curves("g",[10,0],[115,105],[148,100],[255,248]),this.curves("rgb",[0,0],[120,100],[128,140],[255,255]),this.sharpen(20)}),s.Filter.register("pinhole",function(){return this.greyscale(),this.sepia(10),this.exposure(10),this.contrast(15),this.vignette("60%",35)}),s.Filter.register("oldBoot",function(){return this.saturation(-20),this.vibrance(-50),this.gamma(1.1),this.sepia(30),this.channels({red:-10,blue:5}),this.curves("rgb",[0,0],[80,50],[128,230],[255,255]),this.vignette("60%",30)}),s.Filter.register("glowingSun",function(t){if(null==t&&(t=!0),this.brightness(10),this.newLayer(function(){return this.setBlendingMode("multiply"),this.opacity(80),this.copyParent(),this.filter.gamma(.8),this.filter.contrast(50),this.filter.exposure(10)}),this.newLayer(function(){return this.setBlendingMode("softLight"),this.opacity(80),this.fillColor("#f49600")}),this.exposure(20),this.gamma(.8),t)return this.vignette("45%",20)}),s.Filter.register("hazyDays",function(){return this.gamma(1.2),this.newLayer(function(){return this.setBlendingMode("overlay"),this.opacity(60),this.copyParent(),this.filter.channels({red:5}),this.filter.stackBlur(15)}),this.newLayer(function(){return this.setBlendingMode("addition"),this.opacity(40),this.fillColor("#6899ba")}),this.newLayer(function(){return this.setBlendingMode("multiply"),this.opacity(35),this.copyParent(),this.filter.brightness(40),this.filter.vibrance(40),this.filter.exposure(30),this.filter.contrast(15),this.filter.curves("r",[0,40],[128,128],[128,128],[255,215]),this.filter.curves("g",[0,40],[128,128],[128,128],[255,215]),this.filter.curves("b",[0,40],[128,128],[128,128],[255,215]),this.filter.stackBlur(5)}),this.curves("r",[20,0],[128,158],[128,128],[235,255]),this.curves("g",[20,0],[128,128],[128,128],[235,255]),this.curves("b",[20,0],[128,108],[128,128],[235,255]),this.vignette("45%",20)}),s.Filter.register("herMajesty",function(){return this.brightness(40),this.colorize("#ea1c5d",10),this.curves("b",[0,10],[128,180],[190,190],[255,255]),this.newLayer(function(){return this.setBlendingMode("overlay"),this.opacity(50),this.copyParent(),this.filter.gamma(.7),this.newLayer(function(){return this.setBlendingMode("normal"),this.opacity(60),this.fillColor("#ea1c5d")})}),this.newLayer(function(){return this.setBlendingMode("multiply"),this.opacity(60),this.copyParent(),this.filter.saturation(50),this.filter.hue(90),this.filter.contrast(10)}),this.gamma(1.4),this.vibrance(-30),this.newLayer(function(){return this.opacity(10),this.fillColor("#e5f0ff")}),this}),s.Filter.register("nostalgia",function(){return this.saturation(20),this.gamma(1.4),this.greyscale(),this.contrast(5),this.sepia(100),this.channels({red:8,blue:2,green:4}),this.gamma(.8),this.contrast(5),this.exposure(10),this.newLayer(function(){return this.setBlendingMode("overlay"),this.copyParent(),this.opacity(55),this.filter.stackBlur(10)}),this.vignette("50%",30)}),s.Filter.register("hemingway",function(){return this.greyscale(),this.contrast(10),this.gamma(.9),this.newLayer(function(){return this.setBlendingMode("multiply"),this.opacity(40),this.copyParent(),this.filter.exposure(15),this.filter.contrast(15),this.filter.channels({green:10,red:5})}),this.sepia(30),this.curves("rgb",[0,10],[120,90],[180,200],[235,255]),this.channels({red:5,green:-2}),this.exposure(15)}),s.Filter.register("concentrate",function(){return this.sharpen(40),this.saturation(-50),this.channels({red:3}),this.newLayer(function(){return this.setBlendingMode("multiply"),this.opacity(80),this.copyParent(),this.filter.sharpen(5),this.filter.contrast(50),this.filter.exposure(10),this.filter.channels({blue:5})}),this.brightness(10)}),function(){var t,e,i;e=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],i=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24],t=function(){return this.r=0,this.g=0,this.b=0,this.a=0,this.next=null},s.Plugin.register("stackBlur",function(n){var s,o,r,a,h,l,c,d,u,p,f,g,m,v,y,b,x,w,C,I,D,T,$,E,S,k,R,B,L,z,O,P,M,A,W,j,N,_,F,H,Y,X,U,Q;if(!(isNaN(n)||n<1)){for(n|=0,y=this.pixelData,a=n+n+1,(L=this.dimensions.width)<<2,z=L-1,u=(d=this.dimensions.height)-1,B=(I=n+1)*(I+1)/2,$=R=new t,p=j=1;1<=a?j<a:j>a;p=1<=a?++j:--j)$=$.next=new t,p===I&&(E=$);for($.next=R,S=null,k=null,W=M=0,f=e[n],T=i[n],P=N=0;0<=d?N<d:N>d;P=0<=d?++N:--N){for(x=h=s=C=c=r=0,w=I*(b=y[M]),l=I*(v=y[M+1]),o=I*(m=y[M+2]),C+=B*b,c+=B*v,r+=B*m,$=R,p=_=0;0<=I?_<I:_>I;p=0<=I?++_:--_)$.r=b,$.g=v,$.b=m,$=$.next;for(p=F=1;1<=I?F<I:F>I;p=1<=I?++F:--F)g=M+((z<p?z:p)<<2),C+=($.r=b=y[g])*(D=I-p),c+=($.g=v=y[g+1])*D,r+=($.b=m=y[g+2])*D,x+=b,h+=v,s+=m,$=$.next;for(S=R,k=E,O=H=0;0<=L?H<L:H>L;O=0<=L?++H:--H)y[M]=C*f>>T,y[M+1]=c*f>>T,y[M+2]=r*f>>T,C-=w,c-=l,r-=o,w-=S.r,l-=S.g,o-=S.b,g=W+((g=O+n+1)<z?g:z)<<2,C+=x+=S.r=y[g],c+=h+=S.g=y[g+1],r+=s+=S.b=y[g+2],S=S.next,w+=b=k.r,l+=v=k.g,o+=m=k.b,x-=b,h-=v,s-=m,k=k.next,M+=4;W+=L}for(O=Y=0;0<=L?Y<L:Y>L;O=0<=L?++Y:--Y){for(h=s=x=c=r=C=0,w=I*(b=y[M=O<<2]),l=I*(v=y[M+1]),o=I*(m=y[M+2]),C+=B*b,c+=B*v,r+=B*m,$=R,p=X=0;0<=I?X<I:X>I;p=0<=I?++X:--X)$.r=b,$.g=v,$.b=m,$=$.next;for(A=L,p=U=1;1<=n?U<=n:U>=n;p=1<=n?++U:--U)M=A+O<<2,C+=($.r=b=y[M])*(D=I-p),c+=($.g=v=y[M+1])*D,r+=($.b=m=y[M+2])*D,x+=b,h+=v,s+=m,$=$.next,p<u&&(A+=L);for(M=O,S=R,k=E,P=Q=0;0<=d?Q<d:Q>d;P=0<=d?++Q:--Q)y[g=M<<2]=C*f>>T,y[g+1]=c*f>>T,y[g+2]=r*f>>T,C-=w,c-=l,r-=o,w-=S.r,l-=S.g,o-=S.b,g=O+((g=P+I)<u?g:u)*L<<2,C+=x+=S.r=y[g],c+=h+=S.g=y[g+1],r+=s+=S.b=y[g+2],S=S.next,w+=b=k.r,l+=v=k.g,o+=m=k.b,x-=b,h-=v,s-=m,k=k.next,M+=L}return this}}),s.Filter.register("stackBlur",function(t){return this.processPlugin("stackBlur",[t])})}(),s.Filter.register("threshold",function(t){return this.process("threshold",function(e){return.2126*e.r+.7152*e.g+.0722*e.b<t?(e.r=0,e.g=0,e.b=0):(e.r=255,e.g=255,e.b=255),e})})}.call(this),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(t){"use strict";function e(t){return"number"==typeof t&&!isNaN(t)}function i(t){return void 0===t}function n(t,i){var n=[];return e(i)&&n.push(i),n.slice.apply(t,n)}function s(t,e){var i=n(arguments,2);return function(){return t.apply(e,i.concat(n(arguments)))}}function o(t){var e=t.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return e&&(e[1]!==x.protocol||e[2]!==x.hostname||e[3]!==x.port)}function r(t){var e="timestamp="+(new Date).getTime();return t+(-1===t.indexOf("?")?"?":"&")+e}function a(t){return t?' crossOrigin="'+t+'"':""}function h(t,e){var i;return t.naturalWidth&&!ht?e(t.naturalWidth,t.naturalHeight):(i=document.createElement("img"),i.onload=function(){e(this.width,this.height)},void(i.src=t.src))}function l(t){var i=[],n=t.rotate,s=t.scaleX,o=t.scaleY;return e(n)&&0!==n&&i.push("rotate("+n+"deg)"),e(s)&&1!==s&&i.push("scaleX("+s+")"),e(o)&&1!==o&&i.push("scaleY("+o+")"),i.length?i.join(" "):"none"}function c(t,e){var i,n,s=ut(t.degree)%180,o=(s>90?180-s:s)*Math.PI/180,r=pt(o),a=ft(o),h=t.width,l=t.height,c=t.aspectRatio;return e?(i=h/(a+r/c),n=i/c):(i=h*a+l*r,n=h*r+l*a),{width:i,height:n}}function d(i,n){var s,o,r,a=t("<canvas>")[0],h=a.getContext("2d"),l=0,d=0,u=n.naturalWidth,p=n.naturalHeight,f=n.rotate,g=n.scaleX,m=n.scaleY,v=e(g)&&e(m)&&(1!==g||1!==m),y=e(f)&&0!==f,b=y||v,x=u*ut(g||1),w=p*ut(m||1);return v&&(s=x/2,o=w/2),y&&(r=c({width:x,height:w,degree:f}),x=r.width,w=r.height,s=x/2,o=w/2),a.width=x,a.height=w,b&&(l=-u/2,d=-p/2,h.save(),h.translate(s,o)),y&&h.rotate(f*Math.PI/180),v&&h.scale(g,m),h.drawImage(i,vt(l),vt(d),vt(u),vt(p)),b&&h.restore(),a}function u(e){var i=e.length,n=0,s=0;return i&&(t.each(e,function(t,e){n+=e.pageX,s+=e.pageY}),n/=i,s/=i),{pageX:n,pageY:s}}function p(t,e,i){var n,s="";for(n=e,i+=e;n<i;n++)s+=yt(t.getUint8(n));return s}function f(t){var e,i,n,s,o,r,a,h,l,c,d=new D(t),u=d.byteLength;if(255===d.getUint8(0)&&216===d.getUint8(1))for(l=2;l<u;){if(255===d.getUint8(l)&&225===d.getUint8(l+1)){a=l;break}l++}if(a&&(i=a+4,n=a+10,"Exif"===p(d,i,4)&&(r=d.getUint16(n),((o=18761===r)||19789===r)&&42===d.getUint16(n+2,o)&&(s=d.getUint32(n+4,o))>=8&&(h=n+s))),h)for(u=d.getUint16(h,o),c=0;c<u;c++)if(l=h+12*c+2,274===d.getUint16(l,o)){l+=8,e=d.getUint16(l,o),ht&&d.setUint16(l,1,o);break}return e}function g(t){var e,i=t.replace(J,""),n=atob(i),s=n.length,o=new C(s),r=new I(o);for(e=0;e<s;e++)r[e]=n.charCodeAt(e);return o}function m(t){var e,i=new I(t),n=i.length,s="";for(e=0;e<n;e++)s+=yt(i[e]);return"data:image/jpeg;base64,"+T(s)}function v(e,i){this.$element=t(e),this.options=t.extend({},v.DEFAULTS,t.isPlainObject(i)&&i),this.isLoaded=!1,this.isBuilt=!1,this.isCompleted=!1,this.isRotated=!1,this.isCropped=!1,this.isDisabled=!1,this.isReplaced=!1,this.isLimited=!1,this.wheeling=!1,this.isImg=!1,this.originalUrl="",this.canvas=null,this.cropBox=null,this.init()}var y=t(window),b=t(document),x=window.location,w=window.navigator,C=window.ArrayBuffer,I=window.Uint8Array,D=window.DataView,T=window.btoa,$="cropper",E="cropper-modal",S="cropper-hide",k="cropper-hidden",R="cropper-move",B="cropper-crop",L="cropper-disabled",z="mousedown touchstart pointerdown MSPointerDown",O="mousemove touchmove pointermove MSPointerMove",P="mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",M="wheel mousewheel DOMMouseScroll",A="dblclick",W="load."+$,j="error."+$,N="resize."+$,_="build."+$,F="built."+$,H="cropstart."+$,Y="cropmove."+$,X="cropend."+$,U="crop."+$,Q="zoom."+$,q=/^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/,V=/^data:/,J=/^data:([^;]+);base64,/,G=/^data:image\/jpeg.*;base64,/,K="preview",Z="action",tt="se",et="sw",it="ne",nt="nw",st="crop",ot="move",rt="zoom",at=t.isFunction(t("<canvas>")[0].getContext),ht=w&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(w.userAgent),lt=Number,ct=Math.min,dt=Math.max,ut=Math.abs,pt=Math.sin,ft=Math.cos,gt=Math.sqrt,mt=Math.round,vt=Math.floor,yt=String.fromCharCode;v.prototype={constructor:v,init:function(){var t,e=this.$element;if(e.is("img")){if(this.isImg=!0,this.originalUrl=t=e.attr("src"),!t)return;t=e.prop("src")}else e.is("canvas")&&at&&(t=e[0].toDataURL());this.load(t)},trigger:function(e,i){var n=t.Event(e,i);return this.$element.trigger(n),n},load:function(e){var i,n,s=this.options,a=this.$element;if(e&&(a.one(_,s.build),!this.trigger(_).isDefaultPrevented())){if(this.url=e,this.image={},!s.checkOrientation||!C)return this.clone();if(i=t.proxy(this.read,this),V.test(e))return G.test(e)?i(g(e)):this.clone();(n=new XMLHttpRequest).onerror=n.onabort=t.proxy(function(){this.clone()},this),n.onload=function(){i(this.response)},s.checkCrossOrigin&&o(e)&&a.prop("crossOrigin")&&(e=r(e)),n.open("get",e),n.responseType="arraybuffer",n.send()}},read:function(t){var e=this.options,i=f(t),n=this.image,s=0,o=1,r=1;if(i>1)switch(this.url=m(t),i){case 2:o=-1;break;case 3:s=-180;break;case 4:r=-1;break;case 5:s=90,r=-1;break;case 6:s=90;break;case 7:s=90,o=-1;break;case 8:s=-90}e.rotatable&&(n.rotate=s),e.scalable&&(n.scaleX=o,n.scaleY=r),this.clone()},clone:function(){var e,i,n=this.options,s=this.$element,h=this.url,l="";n.checkCrossOrigin&&o(h)&&((l=s.prop("crossOrigin"))?e=h:(l="anonymous",e=r(h))),this.crossOrigin=l,this.crossOriginUrl=e,this.$clone=i=t("<img"+a(l)+' src="'+(e||h)+'">'),this.isImg?s[0].complete?this.start():s.one(W,t.proxy(this.start,this)):i.one(W,t.proxy(this.start,this)).one(j,t.proxy(this.stop,this)).addClass(S).insertAfter(s)},start:function(){var e=this.$element,i=this.$clone;this.isImg||(i.off(j,this.stop),e=i),h(e[0],t.proxy(function(e,i){t.extend(this.image,{naturalWidth:e,naturalHeight:i,aspectRatio:e/i}),this.isLoaded=!0,this.build()},this))},stop:function(){this.$clone.remove(),this.$clone=null},build:function(){var e,i,n,s=this.options,o=this.$element,r=this.$clone;this.isLoaded&&(this.isBuilt&&this.unbuild(),this.$container=o.parent(),this.$cropper=e=t(v.TEMPLATE),this.$canvas=e.find(".cropper-canvas").append(r),this.$dragBox=e.find(".cropper-drag-box"),this.$cropBox=i=e.find(".cropper-crop-box"),this.$viewBox=e.find(".cropper-view-box"),this.$face=n=i.find(".cropper-face"),o.addClass(k).after(e),this.isImg||r.removeClass(S),this.initPreview(),this.bind(),s.aspectRatio=dt(0,s.aspectRatio)||NaN,s.viewMode=dt(0,ct(3,mt(s.viewMode)))||0,s.autoCrop?(this.isCropped=!0,s.modal&&this.$dragBox.addClass(E)):i.addClass(k),s.guides||i.find(".cropper-dashed").addClass(k),s.center||i.find(".cropper-center").addClass(k),s.cropBoxMovable&&n.addClass(R).data(Z,"all"),s.highlight||n.addClass("cropper-invisible"),s.background&&e.addClass("cropper-bg"),s.cropBoxResizable||i.find(".cropper-line, .cropper-point").addClass(k),this.setDragMode(s.dragMode),this.render(),this.isBuilt=!0,this.setData(s.data),o.one(F,s.built),this.completing=setTimeout(t.proxy(function(){this.trigger(F),this.trigger(U,this.getData()),this.isCompleted=!0},this),0))},unbuild:function(){this.isBuilt&&(this.isCompleted||clearTimeout(this.completing),this.isBuilt=!1,this.isCompleted=!1,this.initialImage=null,this.initialCanvas=null,this.initialCropBox=null,this.container=null,this.canvas=null,this.cropBox=null,this.unbind(),this.resetPreview(),this.$preview=null,this.$viewBox=null,this.$cropBox=null,this.$dragBox=null,this.$canvas=null,this.$container=null,this.$cropper.remove(),this.$cropper=null)},render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.isCropped&&this.renderCropBox()},initContainer:function(){var t=this.options,e=this.$element,i=this.$container,n=this.$cropper;n.addClass(k),e.removeClass(k),n.css(this.container={width:dt(i.width(),lt(t.minContainerWidth)||200),height:dt(i.height(),lt(t.minContainerHeight)||100)}),e.addClass(k),n.removeClass(k)},initCanvas:function(){var e,i=this.options.viewMode,n=this.container,s=n.width,o=n.height,r=this.image,a=r.naturalWidth,h=r.naturalHeight,l=90===ut(r.rotate),c=l?h:a,d=l?a:h,u=c/d,p=s,f=o;o*u>s?3===i?p=o*u:f=s/u:3===i?f=s/u:p=o*u,(e={naturalWidth:c,naturalHeight:d,aspectRatio:u,width:p,height:f}).oldLeft=e.left=(s-p)/2,e.oldTop=e.top=(o-f)/2,this.canvas=e,this.isLimited=1===i||2===i,this.limitCanvas(!0,!0),this.initialImage=t.extend({},r),this.initialCanvas=t.extend({},e)},limitCanvas:function(t,e){var i,n,s,o,r=this.options,a=r.viewMode,h=this.container,l=h.width,c=h.height,d=this.canvas,u=d.aspectRatio,p=this.cropBox,f=this.isCropped&&p;t&&(i=lt(r.minCanvasWidth)||0,n=lt(r.minCanvasHeight)||0,a&&(a>1?(i=dt(i,l),n=dt(n,c),3===a&&(n*u>i?i=n*u:n=i/u)):i?i=dt(i,f?p.width:0):n?n=dt(n,f?p.height:0):f&&(i=p.width,(n=p.height)*u>i?i=n*u:n=i/u)),i&&n?n*u>i?n=i/u:i=n*u:i?n=i/u:n&&(i=n*u),d.minWidth=i,d.minHeight=n,d.maxWidth=1/0,d.maxHeight=1/0),e&&(a?(s=l-d.width,o=c-d.height,d.minLeft=ct(0,s),d.minTop=ct(0,o),d.maxLeft=dt(0,s),d.maxTop=dt(0,o),f&&this.isLimited&&(d.minLeft=ct(p.left,p.left+p.width-d.width),d.minTop=ct(p.top,p.top+p.height-d.height),d.maxLeft=p.left,d.maxTop=p.top,2===a&&(d.width>=l&&(d.minLeft=ct(0,s),d.maxLeft=dt(0,s)),d.height>=c&&(d.minTop=ct(0,o),d.maxTop=dt(0,o))))):(d.minLeft=-d.width,d.minTop=-d.height,d.maxLeft=l,d.maxTop=c))},renderCanvas:function(t){var e,i,n=this.canvas,s=this.image,o=s.rotate,r=s.naturalWidth,a=s.naturalHeight;this.isRotated&&(this.isRotated=!1,i=c({width:s.width,height:s.height,degree:o}),(e=i.width/i.height)!==n.aspectRatio&&(n.left-=(i.width-n.width)/2,n.top-=(i.height-n.height)/2,n.width=i.width,n.height=i.height,n.aspectRatio=e,n.naturalWidth=r,n.naturalHeight=a,o%180&&(i=c({width:r,height:a,degree:o}),n.naturalWidth=i.width,n.naturalHeight=i.height),this.limitCanvas(!0,!1))),(n.width>n.maxWidth||n.width<n.minWidth)&&(n.left=n.oldLeft),(n.height>n.maxHeight||n.height<n.minHeight)&&(n.top=n.oldTop),n.width=ct(dt(n.width,n.minWidth),n.maxWidth),n.height=ct(dt(n.height,n.minHeight),n.maxHeight),this.limitCanvas(!1,!0),n.oldLeft=n.left=ct(dt(n.left,n.minLeft),n.maxLeft),n.oldTop=n.top=ct(dt(n.top,n.minTop),n.maxTop),this.$canvas.css({width:n.width,height:n.height,left:n.left,top:n.top}),this.renderImage(),this.isCropped&&this.isLimited&&this.limitCropBox(!0,!0),t&&this.output()},renderImage:function(e){var i,n=this.canvas,s=this.image;s.rotate&&(i=c({width:n.width,height:n.height,degree:s.rotate,aspectRatio:s.aspectRatio},!0)),t.extend(s,i?{width:i.width,height:i.height,left:(n.width-i.width)/2,top:(n.height-i.height)/2}:{width:n.width,height:n.height,left:0,top:0}),this.$clone.css({width:s.width,height:s.height,marginLeft:s.left,marginTop:s.top,transform:l(s)}),e&&this.output()},initCropBox:function(){var e=this.options,i=this.canvas,n=e.aspectRatio,s=lt(e.autoCropArea)||.8,o={width:i.width,height:i.height};n&&(i.height*n>i.width?o.height=o.width/n:o.width=o.height*n),this.cropBox=o,this.limitCropBox(!0,!0),o.width=ct(dt(o.width,o.minWidth),o.maxWidth),o.height=ct(dt(o.height,o.minHeight),o.maxHeight),o.width=dt(o.minWidth,o.width*s),o.height=dt(o.minHeight,o.height*s),o.oldLeft=o.left=i.left+(i.width-o.width)/2,o.oldTop=o.top=i.top+(i.height-o.height)/2,this.initialCropBox=t.extend({},o)},limitCropBox:function(t,e){var i,n,s,o,r=this.options,a=r.aspectRatio,h=this.container,l=h.width,c=h.height,d=this.canvas,u=this.cropBox,p=this.isLimited;t&&(i=lt(r.minCropBoxWidth)||0,n=lt(r.minCropBoxHeight)||0,i=ct(i,l),n=ct(n,c),s=ct(l,p?d.width:l),o=ct(c,p?d.height:c),a&&(i&&n?n*a>i?n=i/a:i=n*a:i?n=i/a:n&&(i=n*a),o*a>s?o=s/a:s=o*a),u.minWidth=ct(i,s),u.minHeight=ct(n,o),u.maxWidth=s,u.maxHeight=o),e&&(p?(u.minLeft=dt(0,d.left),u.minTop=dt(0,d.top),u.maxLeft=ct(l,d.left+d.width)-u.width,u.maxTop=ct(c,d.top+d.height)-u.height):(u.minLeft=0,u.minTop=0,u.maxLeft=l-u.width,u.maxTop=c-u.height))},renderCropBox:function(){var t=this.options,e=this.container,i=e.width,n=e.height,s=this.cropBox;(s.width>s.maxWidth||s.width<s.minWidth)&&(s.left=s.oldLeft),(s.height>s.maxHeight||s.height<s.minHeight)&&(s.top=s.oldTop),s.width=ct(dt(s.width,s.minWidth),s.maxWidth),s.height=ct(dt(s.height,s.minHeight),s.maxHeight),this.limitCropBox(!1,!0),s.oldLeft=s.left=ct(dt(s.left,s.minLeft),s.maxLeft),s.oldTop=s.top=ct(dt(s.top,s.minTop),s.maxTop),t.movable&&t.cropBoxMovable&&this.$face.data(Z,s.width===i&&s.height===n?ot:"all"),this.$cropBox.css({width:s.width,height:s.height,left:s.left,top:s.top}),this.isCropped&&this.isLimited&&this.limitCanvas(!0,!0),this.isDisabled||this.output()},output:function(){this.preview(),this.isCompleted&&this.trigger(U,this.getData())},initPreview:function(){var e,i=a(this.crossOrigin),n=i?this.crossOriginUrl:this.url;this.$preview=t(this.options.preview),this.$clone2=e=t("<img"+i+' src="'+n+'">'),this.$viewBox.html(e),this.$preview.each(function(){var e=t(this);e.data(K,{width:e.width(),height:e.height(),html:e.html()}),e.html("<img"+i+' src="'+n+'" style="display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;">')})},resetPreview:function(){this.$preview.each(function(){var e=t(this),i=e.data(K);e.css({width:i.width,height:i.height}).html(i.html).removeData(K)})},preview:function(){var e=this.image,i=this.canvas,n=this.cropBox,s=n.width,o=n.height,r=e.width,a=e.height,h=n.left-i.left-e.left,c=n.top-i.top-e.top;this.isCropped&&!this.isDisabled&&(this.$clone2.css({width:r,height:a,marginLeft:-h,marginTop:-c,transform:l(e)}),this.$preview.each(function(){var i=t(this),n=i.data(K),d=n.width,u=n.height,p=d,f=u,g=1;s&&(g=d/s,f=o*g),o&&f>u&&(g=u/o,p=s*g,f=u),i.css({width:p,height:f}).find("img").css({width:r*g,height:a*g,marginLeft:-h*g,marginTop:-c*g,transform:l(e)})}))},bind:function(){var e=this.options,i=this.$element,n=this.$cropper;t.isFunction(e.cropstart)&&i.on(H,e.cropstart),t.isFunction(e.cropmove)&&i.on(Y,e.cropmove),t.isFunction(e.cropend)&&i.on(X,e.cropend),t.isFunction(e.crop)&&i.on(U,e.crop),t.isFunction(e.zoom)&&i.on(Q,e.zoom),n.on(z,t.proxy(this.cropStart,this)),e.zoomable&&e.zoomOnWheel&&n.on(M,t.proxy(this.wheel,this)),e.toggleDragModeOnDblclick&&n.on(A,t.proxy(this.dblclick,this)),b.on(O,this._cropMove=s(this.cropMove,this)).on(P,this._cropEnd=s(this.cropEnd,this)),e.responsive&&y.on(N,this._resize=s(this.resize,this))},unbind:function(){var e=this.options,i=this.$element,n=this.$cropper;t.isFunction(e.cropstart)&&i.off(H,e.cropstart),t.isFunction(e.cropmove)&&i.off(Y,e.cropmove),t.isFunction(e.cropend)&&i.off(X,e.cropend),t.isFunction(e.crop)&&i.off(U,e.crop),t.isFunction(e.zoom)&&i.off(Q,e.zoom),n.off(z,this.cropStart),e.zoomable&&e.zoomOnWheel&&n.off(M,this.wheel),e.toggleDragModeOnDblclick&&n.off(A,this.dblclick),b.off(O,this._cropMove).off(P,this._cropEnd),e.responsive&&y.off(N,this._resize)},resize:function(){var e,i,n,s=this.options.restore,o=this.$container,r=this.container;!this.isDisabled&&r&&(1==(n=o.width()/r.width)&&o.height()===r.height||(s&&(e=this.getCanvasData(),i=this.getCropBoxData()),this.render(),s&&(this.setCanvasData(t.each(e,function(t,i){e[t]=i*n})),this.setCropBoxData(t.each(i,function(t,e){i[t]=e*n})))))},dblclick:function(){this.isDisabled||(this.$dragBox.hasClass(B)?this.setDragMode(ot):this.setDragMode(st))},wheel:function(e){var i=e.originalEvent||e,n=lt(this.options.wheelZoomRatio)||.1,s=1;this.isDisabled||(e.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout(t.proxy(function(){this.wheeling=!1},this),50),i.deltaY?s=i.deltaY>0?1:-1:i.wheelDelta?s=-i.wheelDelta/120:i.detail&&(s=i.detail>0?1:-1),this.zoom(-s*n,e)))},cropStart:function(e){var i,n,s=this.options,o=e.originalEvent,r=o&&o.touches,a=e;if(!this.isDisabled){if(r){if((i=r.length)>1){if(!s.zoomable||!s.zoomOnTouch||2!==i)return;a=r[1],this.startX2=a.pageX,this.startY2=a.pageY,n=rt}a=r[0]}if(n=n||t(a.target).data(Z),q.test(n)){if(this.trigger(H,{originalEvent:o,action:n}).isDefaultPrevented())return;e.preventDefault(),this.action=n,this.cropping=!1,this.startX=a.pageX||o&&o.pageX,this.startY=a.pageY||o&&o.pageY,n===st&&(this.cropping=!0,this.$dragBox.addClass(E))}}},cropMove:function(t){var e,i=this.options,n=t.originalEvent,s=n&&n.touches,o=t,r=this.action;if(!this.isDisabled){if(s){if((e=s.length)>1){if(!i.zoomable||!i.zoomOnTouch||2!==e)return;o=s[1],this.endX2=o.pageX,this.endY2=o.pageY}o=s[0]}if(r){if(this.trigger(Y,{originalEvent:n,action:r}).isDefaultPrevented())return;t.preventDefault(),this.endX=o.pageX||n&&n.pageX,this.endY=o.pageY||n&&n.pageY,this.change(o.shiftKey,r===rt?t:null)}}},cropEnd:function(t){var e=t.originalEvent,i=this.action;this.isDisabled||i&&(t.preventDefault(),this.cropping&&(this.cropping=!1,this.$dragBox.toggleClass(E,this.isCropped&&this.options.modal)),this.action="",this.trigger(X,{originalEvent:e,action:i}))},change:function(t,e){var i,n,s=this.options.aspectRatio,o=this.action,r=this.container,a=this.canvas,h=this.cropBox,l=h.width,c=h.height,d=h.left,u=h.top,p=d+l,f=u+c,g=0,m=0,v=r.width,y=r.height,b=!0;switch(!s&&t&&(s=l&&c?l/c:1),this.isLimited&&(g=h.minLeft,m=h.minTop,v=g+ct(r.width,a.width,a.left+a.width),y=m+ct(r.height,a.height,a.top+a.height)),n={x:this.endX-this.startX,y:this.endY-this.startY},s&&(n.X=n.y*s,n.Y=n.x/s),o){case"all":d+=n.x,u+=n.y;break;case"e":if(n.x>=0&&(p>=v||s&&(u<=m||f>=y))){b=!1;break}l+=n.x,s&&(c=l/s,u-=n.Y/2),l<0&&(o="w",l=0);break;case"n":if(n.y<=0&&(u<=m||s&&(d<=g||p>=v))){b=!1;break}c-=n.y,u+=n.y,s&&(l=c*s,d+=n.X/2),c<0&&(o="s",c=0);break;case"w":if(n.x<=0&&(d<=g||s&&(u<=m||f>=y))){b=!1;break}l-=n.x,d+=n.x,s&&(c=l/s,u+=n.Y/2),l<0&&(o="e",l=0);break;case"s":if(n.y>=0&&(f>=y||s&&(d<=g||p>=v))){b=!1;break}c+=n.y,s&&(l=c*s,d-=n.X/2),c<0&&(o="n",c=0);break;case it:if(s){if(n.y<=0&&(u<=m||p>=v)){b=!1;break}c-=n.y,u+=n.y,l=c*s}else n.x>=0?p<v?l+=n.x:n.y<=0&&u<=m&&(b=!1):l+=n.x,n.y<=0?u>m&&(c-=n.y,u+=n.y):(c-=n.y,u+=n.y);l<0&&c<0?(o=et,c=0,l=0):l<0?(o=nt,l=0):c<0&&(o=tt,c=0);break;case nt:if(s){if(n.y<=0&&(u<=m||d<=g)){b=!1;break}c-=n.y,u+=n.y,l=c*s,d+=n.X}else n.x<=0?d>g?(l-=n.x,d+=n.x):n.y<=0&&u<=m&&(b=!1):(l-=n.x,d+=n.x),n.y<=0?u>m&&(c-=n.y,u+=n.y):(c-=n.y,u+=n.y);l<0&&c<0?(o=tt,c=0,l=0):l<0?(o=it,l=0):c<0&&(o=et,c=0);break;case et:if(s){if(n.x<=0&&(d<=g||f>=y)){b=!1;break}l-=n.x,d+=n.x,c=l/s}else n.x<=0?d>g?(l-=n.x,d+=n.x):n.y>=0&&f>=y&&(b=!1):(l-=n.x,d+=n.x),n.y>=0?f<y&&(c+=n.y):c+=n.y;l<0&&c<0?(o=it,c=0,l=0):l<0?(o=tt,l=0):c<0&&(o=nt,c=0);break;case tt:if(s){if(n.x>=0&&(p>=v||f>=y)){b=!1;break}c=(l+=n.x)/s}else n.x>=0?p<v?l+=n.x:n.y>=0&&f>=y&&(b=!1):l+=n.x,n.y>=0?f<y&&(c+=n.y):c+=n.y;l<0&&c<0?(o=nt,c=0,l=0):l<0?(o=et,l=0):c<0&&(o=it,c=0);break;case ot:this.move(n.x,n.y),b=!1;break;case rt:this.zoom(function(t,e,i,n){var s=gt(t*t+e*e);return(gt(i*i+n*n)-s)/s}(ut(this.startX-this.startX2),ut(this.startY-this.startY2),ut(this.endX-this.endX2),ut(this.endY-this.endY2)),e),this.startX2=this.endX2,this.startY2=this.endY2,b=!1;break;case st:if(!n.x||!n.y){b=!1;break}i=this.$cropper.offset(),d=this.startX-i.left,u=this.startY-i.top,l=h.minWidth,c=h.minHeight,n.x>0?o=n.y>0?tt:it:n.x<0&&(d-=l,o=n.y>0?et:nt),n.y<0&&(u-=c),this.isCropped||(this.$cropBox.removeClass(k),this.isCropped=!0,this.isLimited&&this.limitCropBox(!0,!0))}b&&(h.width=l,h.height=c,h.left=d,h.top=u,this.action=o,this.renderCropBox()),this.startX=this.endX,this.startY=this.endY},crop:function(){this.isBuilt&&!this.isDisabled&&(this.isCropped||(this.isCropped=!0,this.limitCropBox(!0,!0),this.options.modal&&this.$dragBox.addClass(E),this.$cropBox.removeClass(k)),this.setCropBoxData(this.initialCropBox))},reset:function(){this.isBuilt&&!this.isDisabled&&(this.image=t.extend({},this.initialImage),this.canvas=t.extend({},this.initialCanvas),this.cropBox=t.extend({},this.initialCropBox),this.renderCanvas(),this.isCropped&&this.renderCropBox())},clear:function(){this.isCropped&&!this.isDisabled&&(t.extend(this.cropBox,{left:0,top:0,width:0,height:0}),this.isCropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),this.$dragBox.removeClass(E),this.$cropBox.addClass(k))},replace:function(t,e){!this.isDisabled&&t&&(this.isImg&&this.$element.attr("src",t),e?(this.url=t,this.$clone.attr("src",t),this.isBuilt&&this.$preview.find("img").add(this.$clone2).attr("src",t)):(this.isImg&&(this.isReplaced=!0),this.options.data=null,this.load(t)))},enable:function(){this.isBuilt&&(this.isDisabled=!1,this.$cropper.removeClass(L))},disable:function(){this.isBuilt&&(this.isDisabled=!0,this.$cropper.addClass(L))},destroy:function(){var t=this.$element;this.isLoaded?(this.isImg&&this.isReplaced&&t.attr("src",this.originalUrl),this.unbuild(),t.removeClass(k)):this.isImg?t.off(W,this.start):this.$clone&&this.$clone.remove(),t.removeData($)},move:function(t,e){var n=this.canvas;this.moveTo(i(t)?t:n.left+lt(t),i(e)?e:n.top+lt(e))},moveTo:function(t,n){var s=this.canvas,o=!1;i(n)&&(n=t),t=lt(t),n=lt(n),this.isBuilt&&!this.isDisabled&&this.options.movable&&(e(t)&&(s.left=t,o=!0),e(n)&&(s.top=n,o=!0),o&&this.renderCanvas(!0))},zoom:function(t,e){var i=this.canvas;t=(t=lt(t))<0?1/(1-t):1+t,this.zoomTo(i.width*t/i.naturalWidth,e)},zoomTo:function(t,e){var i,n,s,o,r,a=this.options,h=this.canvas,l=h.width,c=h.height,d=h.naturalWidth,p=h.naturalHeight;if((t=lt(t))>=0&&this.isBuilt&&!this.isDisabled&&a.zoomable){if(n=d*t,s=p*t,e&&(i=e.originalEvent),this.trigger(Q,{originalEvent:i,oldRatio:l/d,ratio:n/d}).isDefaultPrevented())return;i?(o=this.$cropper.offset(),r=i.touches?u(i.touches):{pageX:e.pageX||i.pageX||0,pageY:e.pageY||i.pageY||0},h.left-=(n-l)*((r.pageX-o.left-h.left)/l),h.top-=(s-c)*((r.pageY-o.top-h.top)/c)):(h.left-=(n-l)/2,h.top-=(s-c)/2),h.width=n,h.height=s,this.renderCanvas(!0)}},rotate:function(t){this.rotateTo((this.image.rotate||0)+lt(t))},rotateTo:function(t){e(t=lt(t))&&this.isBuilt&&!this.isDisabled&&this.options.rotatable&&(this.image.rotate=t%360,this.isRotated=!0,this.renderCanvas(!0))},scale:function(t,n){var s=this.image,o=!1;i(n)&&(n=t),t=lt(t),n=lt(n),this.isBuilt&&!this.isDisabled&&this.options.scalable&&(e(t)&&(s.scaleX=t,o=!0),e(n)&&(s.scaleY=n,o=!0),o&&this.renderImage(!0))},scaleX:function(t){var i=this.image.scaleY;this.scale(t,e(i)?i:1)},scaleY:function(t){var i=this.image.scaleX;this.scale(e(i)?i:1,t)},getData:function(e){var i,n,s=this.options,o=this.image,r=this.canvas,a=this.cropBox;return this.isBuilt&&this.isCropped?(n={x:a.left-r.left,y:a.top-r.top,width:a.width,height:a.height},i=o.width/o.naturalWidth,t.each(n,function(t,s){s/=i,n[t]=e?mt(s):s})):n={x:0,y:0,width:0,height:0},s.rotatable&&(n.rotate=o.rotate||0),s.scalable&&(n.scaleX=o.scaleX||1,n.scaleY=o.scaleY||1),n},setData:function(i){var n,s,o,r=this.options,a=this.image,h=this.canvas,l={};t.isFunction(i)&&(i=i.call(this.element)),this.isBuilt&&!this.isDisabled&&t.isPlainObject(i)&&(r.rotatable&&e(i.rotate)&&i.rotate!==a.rotate&&(a.rotate=i.rotate,this.isRotated=n=!0),r.scalable&&(e(i.scaleX)&&i.scaleX!==a.scaleX&&(a.scaleX=i.scaleX,s=!0),e(i.scaleY)&&i.scaleY!==a.scaleY&&(a.scaleY=i.scaleY,s=!0)),n?this.renderCanvas():s&&this.renderImage(),o=a.width/a.naturalWidth,e(i.x)&&(l.left=i.x*o+h.left),e(i.y)&&(l.top=i.y*o+h.top),e(i.width)&&(l.width=i.width*o),e(i.height)&&(l.height=i.height*o),this.setCropBoxData(l))},getContainerData:function(){return this.isBuilt?this.container:{}},getImageData:function(){return this.isLoaded?this.image:{}},getCanvasData:function(){var e=this.canvas,i={};return this.isBuilt&&t.each(["left","top","width","height","naturalWidth","naturalHeight"],function(t,n){i[n]=e[n]}),i},setCanvasData:function(i){var n=this.canvas,s=n.aspectRatio;t.isFunction(i)&&(i=i.call(this.$element)),this.isBuilt&&!this.isDisabled&&t.isPlainObject(i)&&(e(i.left)&&(n.left=i.left),e(i.top)&&(n.top=i.top),e(i.width)?(n.width=i.width,n.height=i.width/s):e(i.height)&&(n.height=i.height,n.width=i.height*s),this.renderCanvas(!0))},getCropBoxData:function(){var t,e=this.cropBox;return this.isBuilt&&this.isCropped&&(t={left:e.left,top:e.top,width:e.width,height:e.height}),t||{}},setCropBoxData:function(i){var n,s,o=this.cropBox,r=this.options.aspectRatio;t.isFunction(i)&&(i=i.call(this.$element)),this.isBuilt&&this.isCropped&&!this.isDisabled&&t.isPlainObject(i)&&(e(i.left)&&(o.left=i.left),e(i.top)&&(o.top=i.top),e(i.width)&&(n=!0,o.width=i.width),e(i.height)&&(s=!0,o.height=i.height),r&&(n?o.height=o.width/r:s&&(o.width=o.height*r)),this.renderCropBox())},getCroppedCanvas:function(e){var i,n,s,o,r,a,h,l,c,u,p;if(this.isBuilt&&at)return this.isCropped?(t.isPlainObject(e)||(e={}),p=this.getData(),i=p.width,n=p.height,l=i/n,t.isPlainObject(e)&&(r=e.width,a=e.height,r?(a=r/l,h=r/i):a&&(r=a*l,h=a/n)),s=vt(r||i),o=vt(a||n),c=t("<canvas>")[0],c.width=s,c.height=o,u=c.getContext("2d"),e.fillColor&&(u.fillStyle=e.fillColor,u.fillRect(0,0,s,o)),u.drawImage.apply(u,function(){var t,e,s,o,r,a,l=d(this.$clone[0],this.image),c=l.width,u=l.height,f=this.canvas,g=[l],m=p.x+f.naturalWidth*(ut(p.scaleX||1)-1)/2,v=p.y+f.naturalHeight*(ut(p.scaleY||1)-1)/2;return m<=-i||m>c?m=t=s=r=0:m<=0?(s=-m,m=0,t=r=ct(c,i+m)):m<=c&&(s=0,t=r=ct(i,c-m)),t<=0||v<=-n||v>u?v=e=o=a=0:v<=0?(o=-v,v=0,e=a=ct(u,n+v)):v<=u&&(o=0,e=a=ct(n,u-v)),g.push(vt(m),vt(v),vt(t),vt(e)),h&&(s*=h,o*=h,r*=h,a*=h),r>0&&a>0&&g.push(vt(s),vt(o),vt(r),vt(a)),g}.call(this)),c):d(this.$clone[0],this.image)},setAspectRatio:function(t){var e=this.options;this.isDisabled||i(t)||(e.aspectRatio=dt(0,t)||NaN,this.isBuilt&&(this.initCropBox(),this.isCropped&&this.renderCropBox()))},setDragMode:function(t){var e,i,n=this.options;this.isLoaded&&!this.isDisabled&&(e=t===st,i=n.movable&&t===ot,t=e||i?t:"none",this.$dragBox.data(Z,t).toggleClass(B,e).toggleClass(R,i),n.cropBoxMovable||this.$face.data(Z,t).toggleClass(B,e).toggleClass(R,i))}},v.DEFAULTS={viewMode:0,dragMode:"crop",aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,build:null,built:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},v.setDefaults=function(e){t.extend(v.DEFAULTS,e)},v.TEMPLATE='<div class="cropper-container"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-action="e"></span><span class="cropper-line line-n" data-action="n"></span><span class="cropper-line line-w" data-action="w"></span><span class="cropper-line line-s" data-action="s"></span><span class="cropper-point point-e" data-action="e"></span><span class="cropper-point point-n" data-action="n"></span><span class="cropper-point point-w" data-action="w"></span><span class="cropper-point point-s" data-action="s"></span><span class="cropper-point point-ne" data-action="ne"></span><span class="cropper-point point-nw" data-action="nw"></span><span class="cropper-point point-sw" data-action="sw"></span><span class="cropper-point point-se" data-action="se"></span></div></div>',v.other=t.fn.cropper,t.fn.cropper=function(e){var s,o=n(arguments,1);return this.each(function(){var i,n,r=t(this),a=r.data($);if(!a){if(/destroy/.test(e))return;i=t.extend({},r.data(),t.isPlainObject(e)&&e),r.data($,a=new v(this,i))}"string"==typeof e&&t.isFunction(n=a[e])&&(s=n.apply(a,o))}),i(s)?this:s},t.fn.cropper.Constructor=v,t.fn.cropper.setDefaults=v.setDefaults,t.fn.cropper.noConflict=function(){return t.fn.cropper=v.other,this}}),function(t,e){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",e):"object"==typeof module&&module.exports?module.exports=e():t.EvEmitter=e()}("undefined"!=typeof window?window:this,function(){function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},n=i[t]=i[t]||[];return-1==n.indexOf(e)&&n.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{};return(i[t]=i[t]||{})[e]=!0,this}},e.off=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=i.indexOf(e);return-1!=n&&i.splice(n,1),this}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=0,s=i[n];e=e||[];for(var o=this._onceEvents&&this._onceEvents[t];s;){var r=o&&o[s];r&&(this.off(t,s),delete o[s]),s.apply(this,e),s=i[n+=r?0:1]}return this}},e.allOff=e.removeAllListeners=function(){delete this._events,delete this._onceEvents},t}),function(t,e){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("ev-emitter")):t.imagesLoaded=e(t,t.EvEmitter)}("undefined"!=typeof window?window:this,function(t,e){function i(t,e){for(var i in e)t[i]=e[i];return t}function n(t){var e=[];if(Array.isArray(t))e=t;else if("number"==typeof t.length)for(var i=0;i<t.length;i++)e.push(t[i]);else e.push(t);return e}function s(t,e,o){return this instanceof s?("string"==typeof t&&(t=document.querySelectorAll(t)),this.elements=n(t),this.options=i({},this.options),"function"==typeof e?o=e:i(this.options,e),o&&this.on("always",o),this.getImages(),a&&(this.jqDeferred=new a.Deferred),void setTimeout(function(){this.check()}.bind(this))):new s(t,e,o)}function o(t){this.img=t}function r(t,e){this.url=t,this.element=e,this.img=new Image}var a=t.jQuery,h=t.console;s.prototype=Object.create(e.prototype),s.prototype.options={},s.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},s.prototype.addElementImages=function(t){"IMG"==t.nodeName&&this.addImage(t),!0===this.options.background&&this.addElementBackgroundImages(t);var e=t.nodeType;if(e&&l[e]){for(var i=t.querySelectorAll("img"),n=0;n<i.length;n++){var s=i[n];this.addImage(s)}if("string"==typeof this.options.background){var o=t.querySelectorAll(this.options.background);for(n=0;n<o.length;n++){var r=o[n];this.addElementBackgroundImages(r)}}}};var l={1:!0,9:!0,11:!0};return s.prototype.addElementBackgroundImages=function(t){var e=getComputedStyle(t);if(e)for(var i=/url\((['"])?(.*?)\1\)/gi,n=i.exec(e.backgroundImage);null!==n;){var s=n&&n[2];s&&this.addBackground(s,t),n=i.exec(e.backgroundImage)}},s.prototype.addImage=function(t){var e=new o(t);this.images.push(e)},s.prototype.addBackground=function(t,e){var i=new r(t,e);this.images.push(i)},s.prototype.check=function(){function t(t,i,n){setTimeout(function(){e.progress(t,i,n)})}var e=this;return this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(e){e.once("progress",t),e.check()}):void this.complete()},s.prototype.progress=function(t,e,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded,this.emitEvent("progress",[this,t,e]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,t),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&h&&h.log("progress: "+i,t,e)},s.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(t,[this]),this.emitEvent("always",[this]),this.jqDeferred){var e=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[e](this)}},o.prototype=Object.create(e.prototype),o.prototype.check=function(){return this.getIsImageComplete()?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),void(this.proxyImage.src=this.img.src))},o.prototype.getIsImageComplete=function(){return this.img.complete&&void 0!==this.img.naturalWidth},o.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.img,e])},o.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},o.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},o.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},o.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},r.prototype=Object.create(o.prototype),r.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url,this.getIsImageComplete()&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},r.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},r.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.element,e])},s.makeJQueryPlugin=function(e){(e=e||t.jQuery)&&(a=e,a.fn.imagesLoaded=function(t,e){return new s(this,t,e).jqDeferred.promise(a(this))})},s.makeJQueryPlugin(),s}),function(t,e){"use strict";function i(i){var n=e.console;s[i]||(s[i]=!0,t.migrateWarnings.push(i),n&&n.warn&&!t.migrateMute&&(n.warn("JQMIGRATE: "+i),t.migrateTrace&&n.trace&&n.trace()))}function n(t,e,n,s){Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:function(){return i(s),n}})}t.migrateVersion="3.0.0",function(){var i=e.console&&e.console.log&&function(){e.console.log.apply(e.console,arguments)},n=/^[12]\./;i&&(t&&!n.test(t.fn.jquery)||i("JQMIGRATE: jQuery 3.0.0+ REQUIRED"),t.migrateWarnings&&i("JQMIGRATE: Migrate plugin loaded multiple times"),i("JQMIGRATE: Migrate is installed"+(t.migrateMute?"":" with logging active")+", version "+t.migrateVersion))}();var s={};t.migrateWarnings=[],void 0===t.migrateTrace&&(t.migrateTrace=!0),t.migrateReset=function(){s={},t.migrateWarnings.length=0},"BackCompat"===document.compatMode&&i("jQuery is not compatible with Quirks Mode");var o=t.fn.init,r=t.isNumeric,a=t.find,h=/\[(\s*[-\w]+\s*)([~|^$*]?=)\s*([-\w#]*?#[-\w#]*)\s*\]/,l=/\[(\s*[-\w]+\s*)([~|^$*]?=)\s*([-\w#]*?#[-\w#]*)\s*\]/g;t.fn.init=function(t){var e=Array.prototype.slice.call(arguments);return"string"==typeof t&&"#"===t&&(i("jQuery( '#' ) is not a valid selector"),e[0]=[]),o.apply(this,e)},t.fn.init.prototype=t.fn,t.find=function(t){var e=Array.prototype.slice.call(arguments);if("string"==typeof t&&h.test(t))try{document.querySelector(t)}catch(n){t=t.replace(l,function(t,e,i,n){return"["+e+i+'"'+n+'"]'});try{document.querySelector(t),i("Attribute selector with '#' must be quoted: "+e[0]),e[0]=t}catch(t){i("Attribute selector with '#' was not fixed: "+e[0])}}return a.apply(this,e)};var c;for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(t.find[c]=a[c]);t.fn.size=function(){return i("jQuery.fn.size() is deprecated; use the .length property"),this.length},t.parseJSON=function(){return i("jQuery.parseJSON is deprecated; use JSON.parse"),JSON.parse.apply(null,arguments)},t.isNumeric=function(e){var n=r(e),s=function(e){var i=e&&e.toString();return!t.isArray(e)&&i-parseFloat(i)+1>=0}(e);return n!==s&&i("jQuery.isNumeric() should not be called on constructed objects"),s},n(t,"unique",t.uniqueSort,"jQuery.unique is deprecated, use jQuery.uniqueSort"),n(t.expr,"filters",t.expr.pseudos,"jQuery.expr.filters is now jQuery.expr.pseudos"),n(t.expr,":",t.expr.pseudos,'jQuery.expr[":"] is now jQuery.expr.pseudos');var d=t.ajax;t.ajax=function(){var t=d.apply(this,arguments);return t.promise&&(n(t,"success",t.done,"jQXHR.success is deprecated and removed"),n(t,"error",t.fail,"jQXHR.error is deprecated and removed"),n(t,"complete",t.always,"jQXHR.complete is deprecated and removed")),t};var u=t.fn.removeAttr,p=t.fn.toggleClass,f=/\S+/g;t.fn.removeAttr=function(e){var n=this;return t.each(e.match(f),function(e,s){t.expr.match.bool.test(s)&&(i("jQuery.fn.removeAttr no longer sets boolean properties: "+s),n.prop(s,!1))}),u.apply(this,arguments)},t.fn.toggleClass=function(e){return void 0!==e&&"boolean"!=typeof e?p.apply(this,arguments):(i("jQuery.fn.toggleClass( boolean ) is deprecated"),this.each(function(){var i=this.getAttribute&&this.getAttribute("class")||"";i&&t.data(this,"__className__",i),this.setAttribute&&this.setAttribute("class",i||!1===e?"":t.data(this,"__className__")||"")}))};var g=!1;t.swap&&t.each(["height","width","reliableMarginRight"],function(e,i){var n=t.cssHooks[i]&&t.cssHooks[i].get;n&&(t.cssHooks[i].get=function(){var t;return g=!0,t=n.apply(this,arguments),g=!1,t})}),t.swap=function(t,e,n,s){var o,r,a={};g||i("jQuery.swap() is undocumented and deprecated");for(r in e)a[r]=t.style[r],t.style[r]=e[r];o=n.apply(t,s||[]);for(r in e)t.style[r]=a[r];return o};var m=t.data;t.data=function(e,n,s){var o;return n&&n!==t.camelCase(n)&&(o=t.hasData(e)&&m.call(this,e))&&n in o?(i("jQuery.data() always sets/gets camelCased names: "+n),arguments.length>2&&(o[n]=s),o[n]):m.apply(this,arguments)};var v=t.Tween.prototype.run;t.Tween.prototype.run=function(e){t.easing[this.easing].length>1&&(i('easing function "jQuery.easing.'+this.easing.toString()+'" should use only first argument'),t.easing[this.easing]=t.easing[this.easing].bind(t.easing,e,this.options.duration*e,0,1,this.options.duration)),v.apply(this,arguments)};var y=t.fn.load,b=t.event.fix;t.event.props=[],t.event.fixHooks={},t.event.fix=function(e){var n,s=e.type,o=this.fixHooks[s],r=t.event.props;if(r.length)for(i("jQuery.event.props are deprecated and removed: "+r.join());r.length;)t.event.addProp(r.pop());if(o&&!o._migrated_&&(o._migrated_=!0,i("jQuery.event.fixHooks are deprecated and removed: "+s),(r=o.props)&&r.length))for(;r.length;)t.event.addProp(r.pop());return n=b.call(this,e),o&&o.filter?o.filter(n,e):n},t.each(["load","unload","error"],function(e,n){t.fn[n]=function(){var t=Array.prototype.slice.call(arguments,0);return"load"===n&&"string"==typeof t[0]?y.apply(this,t):(i("jQuery.fn."+n+"() is deprecated"),t.splice(0,0,n),arguments.length?this.on.apply(this,t):(this.triggerHandler.apply(this,t),this))}}),t(function(){t(document).triggerHandler("ready")}),t.event.special.ready={setup:function(){this===document&&i("'ready' event is deprecated")}},t.fn.extend({bind:function(t,e,n){return i("jQuery.fn.bind() is deprecated"),this.on(t,null,e,n)},unbind:function(t,e){return i("jQuery.fn.unbind() is deprecated"),this.off(t,null,e)},delegate:function(t,e,n,s){return i("jQuery.fn.delegate() is deprecated"),this.on(e,t,n,s)},undelegate:function(t,e,n){return i("jQuery.fn.undelegate() is deprecated"),1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)}});var x=t.fn.offset;t.fn.offset=function(){var e,n=this[0],s={top:0,left:0};return n&&n.nodeType?(e=(n.ownerDocument||document).documentElement,t.contains(e,n)?x.apply(this,arguments):(i("jQuery.fn.offset() requires an element connected to a document"),s)):(i("jQuery.fn.offset() requires a valid DOM element"),s)};var w=t.param;t.param=function(e,n){var s=t.ajaxSettings&&t.ajaxSettings.traditional;return void 0===n&&s&&(i("jQuery.param() no longer uses jQuery.ajaxSettings.traditional"),n=s),w.call(this,e,n)};var C=t.fn.andSelf||t.fn.addBack;t.fn.andSelf=function(){return i("jQuery.fn.andSelf() replaced by jQuery.fn.addBack()"),C.apply(this,arguments)};var I=t.Deferred,D=[["resolve","done",t.Callbacks("once memory"),t.Callbacks("once memory"),"resolved"],["reject","fail",t.Callbacks("once memory"),t.Callbacks("once memory"),"rejected"],["notify","progress",t.Callbacks("memory"),t.Callbacks("memory")]];t.Deferred=function(e){var n=I(),s=n.promise();return n.pipe=s.pipe=function(){var e=arguments;return i("deferred.pipe() is deprecated"),t.Deferred(function(i){t.each(D,function(o,r){var a=t.isFunction(e[o])&&e[o];n[r[1]](function(){var e=a&&a.apply(this,arguments);e&&t.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[r[0]+"With"](this===s?i.promise():this,a?[e]:arguments)})}),e=null}).promise()},e&&e.call(n,n),n}}(jQuery,window),function(t){t.fn.extend({slimScroll:function(e){var i={axis:"y",width:"auto",height:"250px",size:"7px",color:"#000",positionX:"bottom",positionY:"right",distance:"1px",startX:"left",startY:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:.2,railDraggable:!0,railClassX:"slimScrollRailX",barClassX:"slimScrollBarX",railClassY:"slimScrollRailY",barClassY:"slimScrollBarY",wrapperClass:"slimScrollDiv",allowPageScroll:!1,applyVerticalWheelToHorizontal:!1,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px"},n=t.extend(i,e);return n.axis=n.axis.toLowerCase(),this.each(function(){function i(t){var e=0,i=0;return"detail"in t&&(i=t.detail),"wheelDelta"in t&&(i=-1*t.wheelDelta/6),"wheelDeltaY"in t&&(i=-1*t.wheelDeltaY/6),"wheelDeltaX"in t&&(e=t.wheelDeltaX/6),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=-1*i,i=0),e!==e&&i!==i&&(e=0,i=t.wheelDelta),"deltaY"in t&&(i=t.deltaY),"deltaX"in t&&(e=t.deltaX),[e,i]}function s(e){if(v){var s=i(e=e||window.event),r=s[0],a=s[1],h=e.target||e.srcTarget||e.srcElement;t(h).closest("."+n.wrapperClass).is(P.parent())&&o(r,a,!0),e.preventDefault&&!O&&(e.preventDefault(),e.stopPropagation()),O||(e.returnValue=!1)}}function o(t,e,i,s){if(O=!1,u){var o=moveFactor=t;n.applyVerticalWheelToHorizontal&&"x"==n.axis&&!o&&e&&(o=moveFactor=e);var r=P.outerWidth()-_.outerWidth();if(i&&(o=parseInt(_.css("left"))+moveFactor*parseInt(n.wheelStep)/100,o=Math.min(Math.max(o,0),r),o=moveFactor>0?Math.ceil(o):Math.floor(o),_.css({left:o+"px"})),E=parseInt(_.css("left"))/(P.outerWidth()-_.outerWidth()),o=E*(P[0].scrollWidth-P.outerWidth()),s){var a=(o=t)/P[0].scrollWidth*P.outerWidth();a=Math.min(Math.max(a,0),r),_.css({left:a+"px"})}P.scrollLeft(o),P.trigger("slimscrollingX",~~o),h(),l()}if(p){var f=e,g=P.outerHeight()-Y.outerHeight();if(i&&(f=parseInt(Y.css("top"))+e*parseInt(n.wheelStep)/100,f=Math.min(Math.max(f,0),g),f=e>0?Math.ceil(f):Math.floor(f),Y.css({top:f+"px"})),k=parseInt(Y.css("top"))/(P.outerHeight()-Y.outerHeight()),f=k*(P[0].scrollHeight-P.outerHeight()),s){var m=(f=e)/P[0].scrollHeight*P.outerHeight();m=Math.min(Math.max(m,0),g),Y.css({top:m+"px"})}P.scrollTop(f),P.trigger("slimscrollingY",~~f),c(),d()}}function r(){if(_){$=Math.max(P.outerWidth()/P[0].scrollWidth*P.outerWidth(),z),_.css({width:$+"px"});var t=u&&P[0].scrollWidth>P[0].clientWidth?"block":"none";_.css({display:t})}}function a(){if(Y){T=Math.max(P.outerHeight()/P[0].scrollHeight*P.outerHeight(),L),Y.css({height:T+"px"});var t=p&&P[0].scrollHeight>P[0].clientHeight?"block":"none";Y.css({display:t})}}function h(){if(_){if(r(),clearTimeout(w),E==~~E){if(O=n.allowPageScroll,S!=E){var t=0==~~E?"left":"right";P.trigger("slimscrollX",t)}}else O=!1;S=E,$>=P.outerWidth()?O=!0:(_.stop(!0,!0).fadeIn("fast"),n.railVisible&&N.stop(!0,!0).fadeIn("fast"))}}function l(){_&&(n.alwaysVisible||(w=setTimeout(function(){n.disableFadeOut&&v||y||x||(_.fadeOut("slow"),N.fadeOut("slow"))},1e3)))}function c(){if(Y){if(a(),clearTimeout(C),k==~~k){if(O=n.allowPageScroll,R!=k){var t=0==~~k?"top":"bottom";P.trigger("slimscrollY",t)}}else O=!1;R=k,T>=P.outerHeight()?O=!0:(Y.stop(!0,!0).fadeIn("fast"),n.railVisible&&H.stop(!0,!0).fadeIn("fast"))}}function d(){Y&&(n.alwaysVisible||(C=setTimeout(function(){n.disableFadeOut&&v||b||x||(Y.fadeOut("slow"),H.fadeOut("slow"))},1e3)))}var u,p,f,g,m,v,y,b,x,w,C,I,D,T,$,E,S,k,R,B="<div></div>",L=30,z=30,O=!1,P=t(this),M=t(document);if(P.parent().hasClass(n.wrapperClass)){t.extend(n,P.data("slimScrollConfig")||{});var A=P.scrollLeft(),W=P.scrollTop();return _=P.siblings("."+n.barClassX),N=P.siblings("."+n.railClassX),Y=P.siblings("."+n.barClassY),H=P.siblings("."+n.railClassY),u="both"==n.axis||"x"==n.axis,p="both"==n.axis||"y"==n.axis,r(),a(),t.isPlainObject(e)&&("width"in e&&u&&("auto"==e.width?(P.parent().css("width","auto"),P.css("width","auto"),n.width=P.parent().parent().width()):(n.width=e.width,P.css({"white-space":"nowrap"}))),"height"in e&&p&&("auto"==e.height?(P.parent().css("height","auto"),P.css("height","auto"),n.height=P.parent().parent().height()):n.height=e.height),P.parent().css({position:"relative",overflow:"hidden",width:n.width,height:n.height}),P.css({overflow:"hidden",width:n.width,height:n.height}),"scrollToX"in e?A=parseInt(n.scrollToX):"scrollByX"in e&&(A+=parseInt(n.scrollByX)),"scrollToY"in e?W=parseInt(n.scrollToY):"scrollByY"in e&&(W+=parseInt(n.scrollByY)),"destroy"in e)?(_.remove(),N.remove(),Y.remove(),H.remove(),void P.unwrap()):void o(A,W,!1,!0)}if(!(t.isPlainObject(e)&&"destroy"in e)){u="both"==n.axis||"x"==n.axis,p="both"==n.axis||"y"==n.axis,n.height="auto"==n.height?P.parent().height():n.height,n.width="auto"==n.width?P.parent().width():n.width,P.data("slimScrollConfig",n);var j=t(B).addClass(n.wrapperClass).css({position:"relative",overflow:"hidden",width:n.width,height:n.height});if(P.css({overflow:"hidden",width:n.width,height:n.height}),P.wrap(j),u){"auto"!=n.width&&u&&P.css({"white-space":"nowrap"});var N=t(B).addClass(n.railClassX).css({width:"100%",height:n.size,position:"absolute",left:0,display:n.alwaysVisible&&n.railVisible?"block":"none","border-radius":n.railBorderRadius,background:n.railColor,opacity:n.railOpacity,zIndex:90}),_=t(B).addClass(n.barClassX).css({background:n.color,height:n.size,position:"absolute",left:0,opacity:n.opacity,display:n.alwaysVisible?"block":"none","border-radius":n.borderRadius,BorderRadius:n.borderRadius,MozBorderRadius:n.borderRadius,WebkitBorderRadius:n.borderRadius,zIndex:99}),F="top"==n.positionX?{top:n.distance}:{bottom:n.distance};N.css(F),_.css(F),P.parent().append(_),P.parent().append(N),n.railDraggable&&(_.on("mousedown",function(t){return x=!0,f=parseFloat(_.css("left")),g=t.pageX,M.on("mousemove.slimscrollX",function(t){currLeft=f+t.pageX-g,_.css("left",currLeft),o(0,0,_.position().left)}),M.on("mouseup.slimscrollX",function(t){x=!1,l(),M.unbind(".slimscrollX")}),!1}).on("selectstart.slimscrollX",function(t){return t.stopPropagation(),t.preventDefault(),!1}),N.on("mousedown",function(t){return o((t.offsetX-$/2)*P[0].scrollWidth/P.outerWidth(),0,!1,!0),f=parseFloat(_.css("left")),g=t.pageX,M.on("mousemove.slimscrollX",function(t){currLeft=f+t.pageX-g,_.css("left",currLeft),o(0,0,_.position().left)}),M.on("mouseup.slimscrollX",function(t){x=!1,l(),M.unbind(".slimscrollX")}),!1})),N.hover(function(){h()},function(){l()}),_.hover(function(){y=!0},function(){y=!1}),r(),"right"===n.startX?(_.css({left:P.outerWidth()-_.outerWidth()}),o(0,0,!0)):"left"!==n.startX&&(o(t(n.startX).position().left,null,null,!0),n.alwaysVisible||_.hide())}if(p){var H=t(B).addClass(n.railClassY).css({width:n.size,height:"100%",position:"absolute",top:0,display:n.alwaysVisible&&n.railVisible?"block":"none","border-radius":n.railBorderRadius,background:n.railColor,opacity:n.railOpacity,zIndex:90}),Y=t(B).addClass(n.barClassY).css({background:n.color,width:n.size,position:"absolute",top:0,opacity:n.opacity,display:n.alwaysVisible?"block":"none","border-radius":n.borderRadius,BorderRadius:n.borderRadius,MozBorderRadius:n.borderRadius,WebkitBorderRadius:n.borderRadius,zIndex:99}),X="right"==n.positionY?{right:n.distance}:{left:n.distance};H.css(X),Y.css(X),P.parent().append(Y),P.parent().append(H),n.railDraggable&&(Y.on("mousedown",function(t){return x=!0,f=parseFloat(Y.css("top")),m=t.pageY,M.on("mousemove.slimscrollY",function(t){currTop=f+t.pageY-m,Y.css("top",currTop),o(0,0,Y.position().top)}),M.on("mouseup.slimscrollY",function(t){x=!1,d(),M.unbind(".slimscrollY")}),!1}).on("selectstart.slimscrollY",function(t){return t.stopPropagation(),t.preventDefault(),!1}),H.on("mousedown",function(t){return o(0,(t.offsetY-T/2)*P[0].scrollHeight/P.outerHeight(),!1,!0),f=parseFloat(Y.css("top")),m=t.pageY,M.on("mousemove.slimscrollY",function(t){currTop=f+t.pageY-m,Y.css("top",currTop),o(0,0,Y.position().top)}),M.on("mouseup.slimscrollY",function(t){x=!1,d(),M.unbind(".slimscrollY")}),!1})),H.hover(function(){c()},function(){d()}),Y.hover(function(){b=!0},function(){b=!1}),a(),"bottom"===n.startY?(Y.css({top:P.outerHeight()-Y.outerHeight()}),o(0,0,!0)):"top"!==n.startY&&(o(null,t(n.startY).position().top,null,!0),n.alwaysVisible||Y.hide())}P.hover(function(){v=!0,h(),c(),l(),d()},function(){v=!1,l(),d()}),P.on("touchstart",function(t,e){t.originalEvent.touches.length&&(I=t.originalEvent.touches[0].pageX,D=t.originalEvent.touches[0].pageY)}),P.on("touchmove",function(t){O||t.originalEvent.preventDefault(),t.originalEvent.touches.length&&(o((I-t.originalEvent.touches[0].pageX)/n.touchScrollStep,(D-t.originalEvent.touches[0].pageY)/n.touchScrollStep,!0),I=t.originalEvent.touches[0].pageX,D=t.originalEvent.touches[0].pageY)}),function(t){window.addEventListener?(void 0!==window.onwheel?t.addEventListener("wheel",s,!1):void 0!==window.onmousewheel&&t.addEventListener("mousewheel",s,!1),t.addEventListener("DOMMouseScroll",s,!1)):document.attachEvent("onmousewheel",s)}(this)}}),this.trigger("initialized"),this}}),t.fn.extend({slimscroll:t.fn.slimScroll})}(jQuery),function(t,e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):t.lightbox=e(t.jQuery)}(this,function(t){function e(e){this.album=[],this.currentImageIndex=void 0,this.init(),this.options=t.extend({},this.constructor.defaults),this.option(e)}return e.defaults={albumLabel:"Image %1 of %2",alwaysShowNavOnTouchDevices:!1,fadeDuration:600,fitImagesInViewport:!0,imageFadeDuration:600,positionFromTop:50,resizeDuration:700,showImageNumberLabel:!0,wrapAround:!1,disableScrolling:!1,sanitizeTitle:!1},e.prototype.option=function(e){t.extend(this.options,e)},e.prototype.imageCountLabel=function(t,e){return this.options.albumLabel.replace(/%1/g,t).replace(/%2/g,e)},e.prototype.init=function(){var e=this;t(document).ready(function(){e.enable(),e.build()})},e.prototype.enable=function(){var e=this;t("body").on("click","a[rel^=lightbox], area[rel^=lightbox], a[data-lightbox], area[data-lightbox]",function(i){return e.start(t(i.currentTarget)),!1})},e.prototype.build=function(){var e=this;t('<div id="lightboxOverlay" class="lightboxOverlay"></div><div id="lightbox" class="lightbox"><div class="lb-outerContainer"><div class="lb-container"><img class="lb-image" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" /><div class="lb-nav"><a class="lb-prev" href="" ></a><a class="lb-next" href="" ></a></div><div class="lb-loader"><a class="lb-cancel"></a></div></div></div><div class="lb-dataContainer"><div class="lb-data"><div class="lb-details"><span class="lb-caption"></span><span class="lb-number"></span></div><div class="lb-closeContainer"><a class="lb-close"></a></div></div></div></div>').appendTo(t("body")),this.$lightbox=t("#lightbox"),this.$overlay=t("#lightboxOverlay"),this.$outerContainer=this.$lightbox.find(".lb-outerContainer"),this.$container=this.$lightbox.find(".lb-container"),this.$image=this.$lightbox.find(".lb-image"),this.$nav=this.$lightbox.find(".lb-nav"),this.containerPadding={top:parseInt(this.$container.css("padding-top"),10),right:parseInt(this.$container.css("padding-right"),10),bottom:parseInt(this.$container.css("padding-bottom"),10),left:parseInt(this.$container.css("padding-left"),10)},this.imageBorderWidth={top:parseInt(this.$image.css("border-top-width"),10),right:parseInt(this.$image.css("border-right-width"),10),bottom:parseInt(this.$image.css("border-bottom-width"),10),left:parseInt(this.$image.css("border-left-width"),10)},this.$overlay.hide().on("click",function(){return e.end(),!1}),this.$lightbox.hide().on("click",function(i){return"lightbox"===t(i.target).attr("id")&&e.end(),!1}),this.$outerContainer.on("click",function(i){return"lightbox"===t(i.target).attr("id")&&e.end(),!1}),this.$lightbox.find(".lb-prev").on("click",function(){return 0===e.currentImageIndex?e.changeImage(e.album.length-1):e.changeImage(e.currentImageIndex-1),!1}),this.$lightbox.find(".lb-next").on("click",function(){return e.currentImageIndex===e.album.length-1?e.changeImage(0):e.changeImage(e.currentImageIndex+1),!1}),this.$nav.on("mousedown",function(t){3===t.which&&(e.$nav.css("pointer-events","none"),e.$lightbox.one("contextmenu",function(){setTimeout(function(){this.$nav.css("pointer-events","auto")}.bind(e),0)}))}),this.$lightbox.find(".lb-loader, .lb-close").on("click",function(){return e.end(),!1})},e.prototype.start=function(e){function i(t){n.album.push({link:t.attr("href"),title:t.attr("data-title")||t.attr("title")})}var n=this,s=t(window);s.on("resize",t.proxy(this.sizeOverlay,this)),t("select, object, embed").css({visibility:"hidden"}),this.sizeOverlay(),this.album=[];var o,r=0,a=e.attr("data-lightbox");if(a){o=t(e.prop("tagName")+'[data-lightbox="'+a+'"]');for(var h=0;h<o.length;h=++h)i(t(o[h])),o[h]===e[0]&&(r=h)}else if("lightbox"===e.attr("rel"))i(e);else{o=t(e.prop("tagName")+'[rel="'+e.attr("rel")+'"]');for(var l=0;l<o.length;l=++l)i(t(o[l])),o[l]===e[0]&&(r=l)}var c=s.scrollTop()+this.options.positionFromTop,d=s.scrollLeft();this.$lightbox.css({top:c+"px",left:d+"px"}).fadeIn(this.options.fadeDuration),this.options.disableScrolling&&t("body").addClass("lb-disable-scrolling"),this.changeImage(r)},e.prototype.changeImage=function(e){var i=this;this.disableKeyboardNav();var n=this.$lightbox.find(".lb-image");this.$overlay.fadeIn(this.options.fadeDuration),t(".lb-loader").fadeIn("slow"),this.$lightbox.find(".lb-image, .lb-nav, .lb-prev, .lb-next, .lb-dataContainer, .lb-numbers, .lb-caption").hide(),this.$outerContainer.addClass("animating");var s=new Image;s.onload=function(){var o,r,a,h,l,c;n.attr("src",i.album[e].link),t(s),n.width(s.width),n.height(s.height),i.options.fitImagesInViewport&&(c=t(window).width(),l=t(window).height(),h=c-i.containerPadding.left-i.containerPadding.right-i.imageBorderWidth.left-i.imageBorderWidth.right-20,a=l-i.containerPadding.top-i.containerPadding.bottom-i.imageBorderWidth.top-i.imageBorderWidth.bottom-120,i.options.maxWidth&&i.options.maxWidth<h&&(h=i.options.maxWidth),i.options.maxHeight&&i.options.maxHeight<h&&(a=i.options.maxHeight),(s.width>h||s.height>a)&&(s.width/h>s.height/a?(r=h,o=parseInt(s.height/(s.width/r),10),n.width(r),n.height(o)):(o=a,r=parseInt(s.width/(s.height/o),10),n.width(r),n.height(o)))),i.sizeContainer(n.width(),n.height())},s.src=this.album[e].link,this.currentImageIndex=e},e.prototype.sizeOverlay=function(){this.$overlay.width(t(document).width()).height(t(document).height())},e.prototype.sizeContainer=function(t,e){function i(){n.$lightbox.find(".lb-dataContainer").width(r),n.$lightbox.find(".lb-prevLink").height(a),n.$lightbox.find(".lb-nextLink").height(a),n.showImage()}var n=this,s=this.$outerContainer.outerWidth(),o=this.$outerContainer.outerHeight(),r=t+this.containerPadding.left+this.containerPadding.right+this.imageBorderWidth.left+this.imageBorderWidth.right,a=e+this.containerPadding.top+this.containerPadding.bottom+this.imageBorderWidth.top+this.imageBorderWidth.bottom;s!==r||o!==a?this.$outerContainer.animate({width:r,height:a},this.options.resizeDuration,"swing",function(){i()}):i()},e.prototype.showImage=function(){this.$lightbox.find(".lb-loader").stop(!0).hide(),this.$lightbox.find(".lb-image").fadeIn(this.options.imageFadeDuration),this.updateNav(),this.updateDetails(),this.preloadNeighboringImages(),this.enableKeyboardNav()},e.prototype.updateNav=function(){var t=!1;try{document.createEvent("TouchEvent"),t=!!this.options.alwaysShowNavOnTouchDevices}catch(t){}this.$lightbox.find(".lb-nav").show(),this.album.length>1&&(this.options.wrapAround?(t&&this.$lightbox.find(".lb-prev, .lb-next").css("opacity","1"),this.$lightbox.find(".lb-prev, .lb-next").show()):(this.currentImageIndex>0&&(this.$lightbox.find(".lb-prev").show(),t&&this.$lightbox.find(".lb-prev").css("opacity","1")),this.currentImageIndex<this.album.length-1&&(this.$lightbox.find(".lb-next").show(),t&&this.$lightbox.find(".lb-next").css("opacity","1"))))},e.prototype.updateDetails=function(){var e=this;if(void 0!==this.album[this.currentImageIndex].title&&""!==this.album[this.currentImageIndex].title){var i=this.$lightbox.find(".lb-caption");this.options.sanitizeTitle?i.text(this.album[this.currentImageIndex].title):i.html(this.album[this.currentImageIndex].title),i.fadeIn("fast").find("a").on("click",function(e){void 0!==t(this).attr("target")?window.open(t(this).attr("href"),t(this).attr("target")):location.href=t(this).attr("href")})}if(this.album.length>1&&this.options.showImageNumberLabel){var n=this.imageCountLabel(this.currentImageIndex+1,this.album.length);this.$lightbox.find(".lb-number").text(n).fadeIn("fast")}else this.$lightbox.find(".lb-number").hide();this.$outerContainer.removeClass("animating"),this.$lightbox.find(".lb-dataContainer").fadeIn(this.options.resizeDuration,function(){return e.sizeOverlay()})},e.prototype.preloadNeighboringImages=function(){this.album.length>this.currentImageIndex+1&&((new Image).src=this.album[this.currentImageIndex+1].link),this.currentImageIndex>0&&((new Image).src=this.album[this.currentImageIndex-1].link)},e.prototype.enableKeyboardNav=function(){t(document).on("keyup.keyboard",t.proxy(this.keyboardAction,this))},e.prototype.disableKeyboardNav=function(){t(document).off(".keyboard")},e.prototype.keyboardAction=function(t){var e=t.keyCode,i=String.fromCharCode(e).toLowerCase();27===e||i.match(/x|o|c/)?this.end():"p"===i||37===e?0!==this.currentImageIndex?this.changeImage(this.currentImageIndex-1):this.options.wrapAround&&this.album.length>1&&this.changeImage(this.album.length-1):"n"!==i&&39!==e||(this.currentImageIndex!==this.album.length-1?this.changeImage(this.currentImageIndex+1):this.options.wrapAround&&this.album.length>1&&this.changeImage(0))},e.prototype.end=function(){this.disableKeyboardNav(),t(window).off("resize",this.sizeOverlay),this.$lightbox.fadeOut(this.options.fadeDuration),this.$overlay.fadeOut(this.options.fadeDuration),t("select, object, embed").css({visibility:"visible"}),this.options.disableScrolling&&t("body").removeClass("lb-disable-scrolling")},new e}),function(t,e){"function"==typeof define&&define.amd?define("jquery-bridget/jquery-bridget",["jquery"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("jquery")):t.jQueryBridget=e(t,t.jQuery)}(window,function(t,e){"use strict";function i(i,o,a){function h(t,e,n){var s,o="$()."+i+'("'+e+'")';return t.each(function(t,h){var l=a.data(h,i);if(l){var c=l[e];if(c&&"_"!=e.charAt(0)){var d=c.apply(l,n);s=void 0===s?d:s}else r(o+" is not a valid method")}else r(i+" not initialized. Cannot call methods, i.e. "+o)}),void 0!==s?s:t}function l(t,e){t.each(function(t,n){var s=a.data(n,i);s?(s.option(e),s._init()):(s=new o(n,e),a.data(n,i,s))})}(a=a||e||t.jQuery)&&(o.prototype.option||(o.prototype.option=function(t){a.isPlainObject(t)&&(this.options=a.extend(!0,this.options,t))}),a.fn[i]=function(t){return"string"==typeof t?h(this,t,s.call(arguments,1)):(l(this,t),this)},n(a))}function n(t){!t||t&&t.bridget||(t.bridget=i)}var s=Array.prototype.slice,o=t.console,r=void 0===o?function(){}:function(t){o.error(t)};return n(e||t.jQuery),i}),function(t,e){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",e):"object"==typeof module&&module.exports?module.exports=e():t.EvEmitter=e()}("undefined"!=typeof window?window:this,function(){function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},n=i[t]=i[t]||[];return-1==n.indexOf(e)&&n.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{};return(i[t]=i[t]||{})[e]=!0,this}},e.off=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=i.indexOf(e);return-1!=n&&i.splice(n,1),this}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=0,s=i[n];e=e||[];for(var o=this._onceEvents&&this._onceEvents[t];s;){var r=o&&o[s];r&&(this.off(t,s),delete o[s]),s.apply(this,e),s=i[n+=r?0:1]}return this}},t}),function(t,e){"use strict";"function"==typeof define&&define.amd?define("get-size/get-size",[],function(){return e()}):"object"==typeof module&&module.exports?module.exports=e():t.getSize=e()}(window,function(){"use strict";function t(t){var e=parseFloat(t);return-1==t.indexOf("%")&&!isNaN(e)&&e}function e(){for(var t={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0},e=0;h>e;e++)t[a[e]]=0;return t}function i(t){var e=getComputedStyle(t);return e||r("Style returned "+e+". Are you running this code in a hidden iframe on Firefox? See http://bit.ly/getsizebug1"),e}function n(){if(!l){l=!0;var e=document.createElement("div");e.style.width="200px",e.style.padding="1px 2px 3px 4px",e.style.borderStyle="solid",e.style.borderWidth="1px 2px 3px 4px",e.style.boxSizing="border-box";var n=document.body||document.documentElement;n.appendChild(e);var r=i(e);s.isBoxSizeOuter=o=200==t(r.width),n.removeChild(e)}}function s(s){if(n(),"string"==typeof s&&(s=document.querySelector(s)),s&&"object"==typeof s&&s.nodeType){var r=i(s);if("none"==r.display)return e();var l={};l.width=s.offsetWidth,l.height=s.offsetHeight;for(var c=l.isBorderBox="border-box"==r.boxSizing,d=0;h>d;d++){var u=a[d],p=r[u],f=parseFloat(p);l[u]=isNaN(f)?0:f}var g=l.paddingLeft+l.paddingRight,m=l.paddingTop+l.paddingBottom,v=l.marginLeft+l.marginRight,y=l.marginTop+l.marginBottom,b=l.borderLeftWidth+l.borderRightWidth,x=l.borderTopWidth+l.borderBottomWidth,w=c&&o,C=t(r.width);!1!==C&&(l.width=C+(w?0:g+b));var I=t(r.height);return!1!==I&&(l.height=I+(w?0:m+x)),l.innerWidth=l.width-(g+b),l.innerHeight=l.height-(m+x),l.outerWidth=l.width+v,l.outerHeight=l.height+y,l}}var o,r="undefined"==typeof console?function(){}:function(t){console.error(t)},a=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],h=a.length,l=!1;return s}),function(t,e){"use strict";"function"==typeof define&&define.amd?define("desandro-matches-selector/matches-selector",e):"object"==typeof module&&module.exports?module.exports=e():t.matchesSelector=e()}(window,function(){"use strict";var t=function(){var t=window.Element.prototype;if(t.matches)return"matches";if(t.matchesSelector)return"matchesSelector";for(var e=["webkit","moz","ms","o"],i=0;i<e.length;i++){var n=e[i]+"MatchesSelector";if(t[n])return n}}();return function(e,i){return e[t](i)}}),function(t,e){"function"==typeof define&&define.amd?define("fizzy-ui-utils/utils",["desandro-matches-selector/matches-selector"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("desandro-matches-selector")):t.fizzyUIUtils=e(t,t.matchesSelector)}(window,function(t,e){var i={};i.extend=function(t,e){for(var i in e)t[i]=e[i];return t},i.modulo=function(t,e){return(t%e+e)%e},i.makeArray=function(t){var e=[];if(Array.isArray(t))e=t;else if(t&&"object"==typeof t&&"number"==typeof t.length)for(var i=0;i<t.length;i++)e.push(t[i]);else e.push(t);return e},i.removeFrom=function(t,e){var i=t.indexOf(e);-1!=i&&t.splice(i,1)},i.getParent=function(t,i){for(;t!=document.body;)if(t=t.parentNode,e(t,i))return t},i.getQueryElement=function(t){return"string"==typeof t?document.querySelector(t):t},i.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},i.filterFindElements=function(t,n){var s=[];return(t=i.makeArray(t)).forEach(function(t){if(t instanceof HTMLElement){if(!n)return void s.push(t);e(t,n)&&s.push(t);for(var i=t.querySelectorAll(n),o=0;o<i.length;o++)s.push(i[o])}}),s},i.debounceMethod=function(t,e,i){var n=t.prototype[e],s=e+"Timeout";t.prototype[e]=function(){var t=this[s];t&&clearTimeout(t);var e=arguments,o=this;this[s]=setTimeout(function(){n.apply(o,e),delete o[s]},i||100)}},i.docReady=function(t){var e=document.readyState;"complete"==e||"interactive"==e?setTimeout(t):document.addEventListener("DOMContentLoaded",t)},i.toDashed=function(t){return t.replace(/(.)([A-Z])/g,function(t,e,i){return e+"-"+i}).toLowerCase()};var n=t.console;return i.htmlInit=function(e,s){i.docReady(function(){var o=i.toDashed(s),r="data-"+o,a=document.querySelectorAll("["+r+"]"),h=document.querySelectorAll(".js-"+o),l=i.makeArray(a).concat(i.makeArray(h)),c=r+"-options",d=t.jQuery;l.forEach(function(t){var i,o=t.getAttribute(r)||t.getAttribute(c);try{i=o&&JSON.parse(o)}catch(e){return void(n&&n.error("Error parsing "+r+" on "+t.className+": "+e))}var a=new e(t,i);d&&d.data(t,s,a)})})},i}),function(t,e){"function"==typeof define&&define.amd?define("outlayer/item",["ev-emitter/ev-emitter","get-size/get-size"],e):"object"==typeof module&&module.exports?module.exports=e(require("ev-emitter"),require("get-size")):(t.Outlayer={},t.Outlayer.Item=e(t.EvEmitter,t.getSize))}(window,function(t,e){"use strict";function i(t){for(var e in t)return!1;return null,!0}function n(t,e){t&&(this.element=t,this.layout=e,this.position={x:0,y:0},this._create())}var s=document.documentElement.style,o="string"==typeof s.transition?"transition":"WebkitTransition",r="string"==typeof s.transform?"transform":"WebkitTransform",a={WebkitTransition:"webkitTransitionEnd",transition:"transitionend"}[o],h={transform:r,transition:o,transitionDuration:o+"Duration",transitionProperty:o+"Property",transitionDelay:o+"Delay"},l=n.prototype=Object.create(t.prototype);l.constructor=n,l._create=function(){this._transn={ingProperties:{},clean:{},onEnd:{}},this.css({position:"absolute"})},l.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},l.getSize=function(){this.size=e(this.element)},l.css=function(t){var e=this.element.style;for(var i in t)e[h[i]||i]=t[i]},l.getPosition=function(){var t=getComputedStyle(this.element),e=this.layout._getOption("originLeft"),i=this.layout._getOption("originTop"),n=t[e?"left":"right"],s=t[i?"top":"bottom"],o=this.layout.size,r=-1!=n.indexOf("%")?parseFloat(n)/100*o.width:parseInt(n,10),a=-1!=s.indexOf("%")?parseFloat(s)/100*o.height:parseInt(s,10);r=isNaN(r)?0:r,a=isNaN(a)?0:a,r-=e?o.paddingLeft:o.paddingRight,a-=i?o.paddingTop:o.paddingBottom,this.position.x=r,this.position.y=a},l.layoutPosition=function(){var t=this.layout.size,e={},i=this.layout._getOption("originLeft"),n=this.layout._getOption("originTop"),s=i?"paddingLeft":"paddingRight",o=i?"left":"right",r=i?"right":"left",a=this.position.x+t[s];e[o]=this.getXValue(a),e[r]="";var h=n?"paddingTop":"paddingBottom",l=n?"top":"bottom",c=n?"bottom":"top",d=this.position.y+t[h];e[l]=this.getYValue(d),e[c]="",this.css(e),this.emitEvent("layout",[this])},l.getXValue=function(t){var e=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&!e?t/this.layout.size.width*100+"%":t+"px"},l.getYValue=function(t){var e=this.layout._getOption("horizontal");return this.layout.options.percentPosition&&e?t/this.layout.size.height*100+"%":t+"px"},l._transitionTo=function(t,e){this.getPosition();var i=this.position.x,n=this.position.y,s=parseInt(t,10),o=parseInt(e,10),r=s===this.position.x&&o===this.position.y;if(this.setPosition(t,e),!r||this.isTransitioning){var a=t-i,h=e-n,l={};l.transform=this.getTranslate(a,h),this.transition({to:l,onTransitionEnd:{transform:this.layoutPosition},isCleaning:!0})}else this.layoutPosition()},l.getTranslate=function(t,e){var i=this.layout._getOption("originLeft"),n=this.layout._getOption("originTop");return t=i?t:-t,e=n?e:-e,"translate3d("+t+"px, "+e+"px, 0)"},l.goTo=function(t,e){this.setPosition(t,e),this.layoutPosition()},l.moveTo=l._transitionTo,l.setPosition=function(t,e){this.position.x=parseInt(t,10),this.position.y=parseInt(e,10)},l._nonTransition=function(t){this.css(t.to),t.isCleaning&&this._removeStyles(t.to);for(var e in t.onTransitionEnd)t.onTransitionEnd[e].call(this)},l.transition=function(t){if(parseFloat(this.layout.options.transitionDuration)){var e=this._transn;for(var i in t.onTransitionEnd)e.onEnd[i]=t.onTransitionEnd[i];for(i in t.to)e.ingProperties[i]=!0,t.isCleaning&&(e.clean[i]=!0);if(t.from){this.css(t.from);this.element.offsetHeight;null}this.enableTransition(t.to),this.css(t.to),this.isTransitioning=!0}else this._nonTransition(t)};var c="opacity,"+function(t){return t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()})}(r);l.enableTransition=function(){if(!this.isTransitioning){var t=this.layout.options.transitionDuration;t="number"==typeof t?t+"ms":t,this.css({transitionProperty:c,transitionDuration:t,transitionDelay:this.staggerDelay||0}),this.element.addEventListener(a,this,!1)}},l.onwebkitTransitionEnd=function(t){this.ontransitionend(t)},l.onotransitionend=function(t){this.ontransitionend(t)};var d={"-webkit-transform":"transform"};l.ontransitionend=function(t){if(t.target===this.element){var e=this._transn,n=d[t.propertyName]||t.propertyName;delete e.ingProperties[n],i(e.ingProperties)&&this.disableTransition(),n in e.clean&&(this.element.style[t.propertyName]="",delete e.clean[n]),n in e.onEnd&&(e.onEnd[n].call(this),delete e.onEnd[n]),this.emitEvent("transitionEnd",[this])}},l.disableTransition=function(){this.removeTransitionStyles(),this.element.removeEventListener(a,this,!1),this.isTransitioning=!1},l._removeStyles=function(t){var e={};for(var i in t)e[i]="";this.css(e)};var u={transitionProperty:"",transitionDuration:"",transitionDelay:""};return l.removeTransitionStyles=function(){this.css(u)},l.stagger=function(t){t=isNaN(t)?0:t,this.staggerDelay=t+"ms"},l.removeElem=function(){this.element.parentNode.removeChild(this.element),this.css({display:""}),this.emitEvent("remove",[this])},l.remove=function(){return o&&parseFloat(this.layout.options.transitionDuration)?(this.once("transitionEnd",function(){this.removeElem()}),void this.hide()):void this.removeElem()},l.reveal=function(){delete this.isHidden,this.css({display:""});var t=this.layout.options,e={};e[this.getHideRevealTransitionEndProperty("visibleStyle")]=this.onRevealTransitionEnd,this.transition({from:t.hiddenStyle,to:t.visibleStyle,isCleaning:!0,onTransitionEnd:e})},l.onRevealTransitionEnd=function(){this.isHidden||this.emitEvent("reveal")},l.getHideRevealTransitionEndProperty=function(t){var e=this.layout.options[t];if(e.opacity)return"opacity";for(var i in e)return i},l.hide=function(){this.isHidden=!0,this.css({display:""});var t=this.layout.options,e={};e[this.getHideRevealTransitionEndProperty("hiddenStyle")]=this.onHideTransitionEnd,this.transition({from:t.visibleStyle,to:t.hiddenStyle,isCleaning:!0,onTransitionEnd:e})},l.onHideTransitionEnd=function(){this.isHidden&&(this.css({display:"none"}),this.emitEvent("hide"))},l.destroy=function(){this.css({position:"",left:"",right:"",top:"",bottom:"",transition:"",transform:""})},n}),function(t,e){"use strict";"function"==typeof define&&define.amd?define("outlayer/outlayer",["ev-emitter/ev-emitter","get-size/get-size","fizzy-ui-utils/utils","./item"],function(i,n,s,o){return e(t,i,n,s,o)}):"object"==typeof module&&module.exports?module.exports=e(t,require("ev-emitter"),require("get-size"),require("fizzy-ui-utils"),require("./item")):t.Outlayer=e(t,t.EvEmitter,t.getSize,t.fizzyUIUtils,t.Outlayer.Item)}(window,function(t,e,i,n,s){"use strict";function o(t,e){var i=n.getQueryElement(t);if(i){this.element=i,l&&(this.$element=l(this.element)),this.options=n.extend({},this.constructor.defaults),this.option(e);var s=++d;this.element.outlayerGUID=s,u[s]=this,this._create(),this._getOption("initLayout")&&this.layout()}else h&&h.error("Bad element for "+this.constructor.namespace+": "+(i||t))}function r(t){function e(){t.apply(this,arguments)}return e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e}function a(t){if("number"==typeof t)return t;var e=t.match(/(^\d*\.?\d*)(\w*)/),i=e&&e[1],n=e&&e[2];return i.length?(i=parseFloat(i))*(f[n]||1):0}var h=t.console,l=t.jQuery,c=function(){},d=0,u={};o.namespace="outlayer",o.Item=s,o.defaults={containerStyle:{position:"relative"},initLayout:!0,originLeft:!0,originTop:!0,resize:!0,resizeContainer:!0,transitionDuration:"0.4s",hiddenStyle:{opacity:0,transform:"scale(0.001)"},visibleStyle:{opacity:1,transform:"scale(1)"}};var p=o.prototype;n.extend(p,e.prototype),p.option=function(t){n.extend(this.options,t)},p._getOption=function(t){var e=this.constructor.compatOptions[t];return e&&void 0!==this.options[e]?this.options[e]:this.options[t]},o.compatOptions={initLayout:"isInitLayout",horizontal:"isHorizontal",layoutInstant:"isLayoutInstant",originLeft:"isOriginLeft",originTop:"isOriginTop",resize:"isResizeBound",resizeContainer:"isResizingContainer"},p._create=function(){this.reloadItems(),this.stamps=[],this.stamp(this.options.stamp),n.extend(this.element.style,this.options.containerStyle),this._getOption("resize")&&this.bindResize()},p.reloadItems=function(){this.items=this._itemize(this.element.children)},p._itemize=function(t){for(var e=this._filterFindItemElements(t),i=this.constructor.Item,n=[],s=0;s<e.length;s++){var o=new i(e[s],this);n.push(o)}return n},p._filterFindItemElements=function(t){return n.filterFindElements(t,this.options.itemSelector)},p.getItemElements=function(){return this.items.map(function(t){return t.element})},p.layout=function(){this._resetLayout(),this._manageStamps();var t=this._getOption("layoutInstant"),e=void 0!==t?t:!this._isLayoutInited;this.layoutItems(this.items,e),this._isLayoutInited=!0},p._init=p.layout,p._resetLayout=function(){this.getSize()},p.getSize=function(){this.size=i(this.element)},p._getMeasurement=function(t,e){var n,s=this.options[t];s?("string"==typeof s?n=this.element.querySelector(s):s instanceof HTMLElement&&(n=s),this[t]=n?i(n)[e]:s):this[t]=0},p.layoutItems=function(t,e){t=this._getItemsForLayout(t),this._layoutItems(t,e),this._postLayout()},p._getItemsForLayout=function(t){return t.filter(function(t){return!t.isIgnored})},p._layoutItems=function(t,e){if(this._emitCompleteOnItems("layout",t),t&&t.length){var i=[];t.forEach(function(t){var n=this._getItemLayoutPosition(t);n.item=t,n.isInstant=e||t.isLayoutInstant,i.push(n)},this),this._processLayoutQueue(i)}},p._getItemLayoutPosition=function(){return{x:0,y:0}},p._processLayoutQueue=function(t){this.updateStagger(),t.forEach(function(t,e){this._positionItem(t.item,t.x,t.y,t.isInstant,e)},this)},p.updateStagger=function(){var t=this.options.stagger;return null===t||void 0===t?void(this.stagger=0):(this.stagger=a(t),this.stagger)},p._positionItem=function(t,e,i,n,s){n?t.goTo(e,i):(t.stagger(s*this.stagger),t.moveTo(e,i))},p._postLayout=function(){this.resizeContainer()},p.resizeContainer=function(){if(this._getOption("resizeContainer")){var t=this._getContainerSize();t&&(this._setContainerMeasure(t.width,!0),this._setContainerMeasure(t.height,!1))}},p._getContainerSize=c,p._setContainerMeasure=function(t,e){if(void 0!==t){var i=this.size;i.isBorderBox&&(t+=e?i.paddingLeft+i.paddingRight+i.borderLeftWidth+i.borderRightWidth:i.paddingBottom+i.paddingTop+i.borderTopWidth+i.borderBottomWidth),t=Math.max(t,0),this.element.style[e?"width":"height"]=t+"px"}},p._emitCompleteOnItems=function(t,e){function i(){s.dispatchEvent(t+"Complete",null,[e])}function n(){++r==o&&i()}var s=this,o=e.length;if(e&&o){var r=0;e.forEach(function(e){e.once(t,n)})}else i()},p.dispatchEvent=function(t,e,i){var n=e?[e].concat(i):i;if(this.emitEvent(t,n),l)if(this.$element=this.$element||l(this.element),e){var s=l.Event(e);s.type=t,this.$element.trigger(s,i)}else this.$element.trigger(t,i)},p.ignore=function(t){var e=this.getItem(t);e&&(e.isIgnored=!0)},p.unignore=function(t){var e=this.getItem(t);e&&delete e.isIgnored},p.stamp=function(t){(t=this._find(t))&&(this.stamps=this.stamps.concat(t),t.forEach(this.ignore,this))},p.unstamp=function(t){(t=this._find(t))&&t.forEach(function(t){n.removeFrom(this.stamps,t),this.unignore(t)},this)},p._find=function(t){return t?("string"==typeof t&&(t=this.element.querySelectorAll(t)),t=n.makeArray(t)):void 0},p._manageStamps=function(){this.stamps&&this.stamps.length&&(this._getBoundingRect(),this.stamps.forEach(this._manageStamp,this))},p._getBoundingRect=function(){var t=this.element.getBoundingClientRect(),e=this.size;this._boundingRect={left:t.left+e.paddingLeft+e.borderLeftWidth,top:t.top+e.paddingTop+e.borderTopWidth,right:t.right-(e.paddingRight+e.borderRightWidth),bottom:t.bottom-(e.paddingBottom+e.borderBottomWidth)}},p._manageStamp=c,p._getElementOffset=function(t){var e=t.getBoundingClientRect(),n=this._boundingRect,s=i(t);return{left:e.left-n.left-s.marginLeft,top:e.top-n.top-s.marginTop,right:n.right-e.right-s.marginRight,bottom:n.bottom-e.bottom-s.marginBottom}},p.handleEvent=n.handleEvent,p.bindResize=function(){t.addEventListener("resize",this),this.isResizeBound=!0},p.unbindResize=function(){t.removeEventListener("resize",this),this.isResizeBound=!1},p.onresize=function(){this.resize()},n.debounceMethod(o,"onresize",100),p.resize=function(){this.isResizeBound&&this.needsResizeLayout()&&this.layout()},p.needsResizeLayout=function(){var t=i(this.element);return this.size&&t&&t.innerWidth!==this.size.innerWidth},p.addItems=function(t){var e=this._itemize(t);return e.length&&(this.items=this.items.concat(e)),e},p.appended=function(t){var e=this.addItems(t);e.length&&(this.layoutItems(e,!0),this.reveal(e))},p.prepended=function(t){var e=this._itemize(t);if(e.length){var i=this.items.slice(0);this.items=e.concat(i),this._resetLayout(),this._manageStamps(),this.layoutItems(e,!0),this.reveal(e),this.layoutItems(i)}},p.reveal=function(t){if(this._emitCompleteOnItems("reveal",t),t&&t.length){var e=this.updateStagger();t.forEach(function(t,i){t.stagger(i*e),t.reveal()})}},p.hide=function(t){if(this._emitCompleteOnItems("hide",t),t&&t.length){var e=this.updateStagger();t.forEach(function(t,i){t.stagger(i*e),t.hide()})}},p.revealItemElements=function(t){var e=this.getItems(t);this.reveal(e)},p.hideItemElements=function(t){var e=this.getItems(t);this.hide(e)},p.getItem=function(t){for(var e=0;e<this.items.length;e++){var i=this.items[e];if(i.element==t)return i}},p.getItems=function(t){var e=[];return(t=n.makeArray(t)).forEach(function(t){var i=this.getItem(t);i&&e.push(i)},this),e},p.remove=function(t){var e=this.getItems(t);this._emitCompleteOnItems("remove",e),e&&e.length&&e.forEach(function(t){t.remove(),n.removeFrom(this.items,t)},this)},p.destroy=function(){var t=this.element.style;t.height="",t.position="",t.width="",this.items.forEach(function(t){t.destroy()}),this.unbindResize();var e=this.element.outlayerGUID;delete u[e],delete this.element.outlayerGUID,l&&l.removeData(this.element,this.constructor.namespace)},o.data=function(t){var e=(t=n.getQueryElement(t))&&t.outlayerGUID;return e&&u[e]},o.create=function(t,e){var i=r(o);return i.defaults=n.extend({},o.defaults),n.extend(i.defaults,e),i.compatOptions=n.extend({},o.compatOptions),i.namespace=t,i.data=o.data,i.Item=r(s),n.htmlInit(i,t),l&&l.bridget&&l.bridget(t,i),i};var f={ms:1,s:1e3};return o.Item=s,o}),function(t,e){"function"==typeof define&&define.amd?define(["outlayer/outlayer","get-size/get-size"],e):"object"==typeof module&&module.exports?module.exports=e(require("outlayer"),require("get-size")):t.Masonry=e(t.Outlayer,t.getSize)}(window,function(t,e){var i=t.create("masonry");i.compatOptions.fitWidth="isFitWidth";var n=i.prototype;return n._resetLayout=function(){this.getSize(),this._getMeasurement("columnWidth","outerWidth"),this._getMeasurement("gutter","outerWidth"),this.measureColumns(),this.colYs=[];for(var t=0;t<this.cols;t++)this.colYs.push(0);this.maxY=0,this.horizontalColIndex=0},n.measureColumns=function(){if(this.getContainerWidth(),!this.columnWidth){var t=this.items[0],i=t&&t.element;this.columnWidth=i&&e(i).outerWidth||this.containerWidth}var n=this.columnWidth+=this.gutter,s=this.containerWidth+this.gutter,o=s/n,r=n-s%n,a=r&&1>r?"round":"floor";o=Math[a](o),this.cols=Math.max(o,1)},n.getContainerWidth=function(){var t=this._getOption("fitWidth")?this.element.parentNode:this.element,i=e(t);this.containerWidth=i&&i.innerWidth},n._getItemLayoutPosition=function(t){t.getSize();var e=t.size.outerWidth%this.columnWidth,i=e&&1>e?"round":"ceil",n=Math[i](t.size.outerWidth/this.columnWidth);n=Math.min(n,this.cols);for(var s=this[this.options.horizontalOrder?"_getHorizontalColPosition":"_getTopColPosition"](n,t),o={x:this.columnWidth*s.col,y:s.y},r=s.y+t.size.outerHeight,a=n+s.col,h=s.col;a>h;h++)this.colYs[h]=r;return o},n._getTopColPosition=function(t){var e=this._getTopColGroup(t),i=Math.min.apply(Math,e);return{col:e.indexOf(i),y:i}},n._getTopColGroup=function(t){if(2>t)return this.colYs;for(var e=[],i=this.cols+1-t,n=0;i>n;n++)e[n]=this._getColGroupY(n,t);return e},n._getColGroupY=function(t,e){if(2>e)return this.colYs[t];var i=this.colYs.slice(t,t+e);return Math.max.apply(Math,i)},n._getHorizontalColPosition=function(t,e){var i=this.horizontalColIndex%this.cols;i=t>1&&i+t>this.cols?0:i;var n=e.size.outerWidth&&e.size.outerHeight;return this.horizontalColIndex=n?i+t:this.horizontalColIndex,{col:i,y:this._getColGroupY(i,t)}},n._manageStamp=function(t){var i=e(t),n=this._getElementOffset(t),s=this._getOption("originLeft")?n.left:n.right,o=s+i.outerWidth,r=Math.floor(s/this.columnWidth);r=Math.max(0,r);var a=Math.floor(o/this.columnWidth);a-=o%this.columnWidth?0:1,a=Math.min(this.cols-1,a);for(var h=(this._getOption("originTop")?n.top:n.bottom)+i.outerHeight,l=r;a>=l;l++)this.colYs[l]=Math.max(h,this.colYs[l])},n._getContainerSize=function(){this.maxY=Math.max.apply(Math,this.colYs);var t={height:this.maxY};return this._getOption("fitWidth")&&(t.width=this._getContainerFitWidth()),t},n._getContainerFitWidth=function(){for(var t=0,e=this.cols;--e&&0===this.colYs[e];)t++;return(this.cols-t)*this.columnWidth-this.gutter},n.needsResizeLayout=function(){var t=this.containerWidth;return this.getContainerWidth(),t!=this.containerWidth},i});